---
layout: post
title: Habilitando CGI e .sh no Apache do Debian Jessie
date: '2015-09-13T06:16:00.000-07:00'
author: Marcos Oliveira
tags:
- Debian
- Shell Script
- Apache
- Dicas
modified_time: '2015-09-13T06:16:50.432-07:00'
thumbnail: http://1.bp.blogspot.com/-LkF8Hg4_jIo/VfVyloiTbzI/AAAAAAAAExA/0u4Vibxi83M/s72-c/gnuapache.jpg
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-7978952834631270074
blogger_orig_url: http://www.terminalroot.com.br/2015/09/habilitando-cgi-e-sh-no-apache-do.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-LkF8Hg4_jIo/VfVyloiTbzI/AAAAAAAAExA/0u4Vibxi83M/s1600/gnuapache.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-LkF8Hg4_jIo/VfVyloiTbzI/AAAAAAAAExA/0u4Vibxi83M/s1600/gnuapache.jpg" /></a></div><br /><h3><span style="font-size: large;"><b>Iremos admitir que você já sabe instalar o <a href="http://www.apache.org/" target="_blank"><span style="color: #cc0000;">Apache</span></a> e já utiliza-o com <i>PHP, <strike>HTML</strike></i>,... , caso não saiba pesquise na internet como instalá-los. O bom de usar CGI é que você pode executar comando do Shell Script na sua página Web.</b></span></h3><b><br /></b><br /><h4><span style="font-size: large;"><b>A maioria das distribuições já possuem o <span style="font-size: x-large;">módulo CGI</span> do Apache configurado e com o suporte a ele.</b></span></h4><b><br />{% highlight bash %}LoadModule cgi_module /usr/lib/apache/1.3/mod_cgi.so{% endhighlight %}<br /><br />Caso deseje certificar-se de que o módulo já está <u>carregado</u>, basta verificar em:<br /></b><br /><blockquote class="tr_bq"><b>Obs: Estou usando o <a href="http://www.nano-editor.org/" target="_blank"><span style="color: purple;"><span style="font-size: large;">Editor Nano</span></span></a>, mas vc pode usar o de sua preferência.</b></blockquote><b><br />Logue-se como root , se não possuir o sudo.<br /><br />{% highlight bash %}$ su{% endhighlight %}<br /><br />{% highlight bash %}# nano /etc/apache2/mods-available/cgi.load{% endhighlight %}<br /><br />Certifique-se também de que já está <u>habilitado</u>:<br /><br />{% highlight bash %}nano /etc/apache2/mods-enabled/cgi.load{% endhighlight %}<br /><br />Se estiver <u>comentado</u> (<span style="font-size: large;">#</span>), "descomente" e salve o arquivo.<br /><br />Agora vamos informar ao Apache quais os <u>formatos</u> que desejamos trabalhar:<br /><br />{% highlight bash %}nano /etc/apache2/mods-enabled/mime.conf{% endhighlight %}<br /><br />Procure nele a <u>linha</u> que possui o seguinte código:<br /></b><br /><div class="adp"><b>#AddHandler cgi-script .cgi</b></div><b><br /><br />Se estiver comentado, "descomente" e adicione o <span style="font-size: large;">.sh</span> no final, deixando-o assim:<br /><br /><div class="adp">AddHandler cgi-script .cgi .sh</div><br /><br />Caso não esteja habilitado, rode esse comando para leitura de arquivos CGI:<br /><br />{% highlight bash %}a2enmod cgi{% endhighlight %}<br /><br />Por padrão no <a href="https://www.debian.org/releases/stable/" target="_blank"><span style="font-size: large;"><span style="color: red;">Debian Jessie</span></span></a> há uma pasta que manda o <span style="color: blue;">http://localhost/cgi-bin/</span> para <span style="color: blue;">/usr/lib/cgi-bin</span> , ou seja, se você pôr um arquivo <u>cgi</u> dentro de <span style="color: blue;">/usr/lib/cgi-bin</span> automaticamente quando vc acessar seu <span style="color: blue;">http://localhost/cgi-bin/</span> ele irá acessar <span style="color: blue;">/usr/lib/cgi-bin</span> . Mas caso vc deseje alterar o endereço, para por exemplo: <span style="color: purple;">http://localhost/sh/</span> , então vc precisa editar o arquivo <span style="color: #0b5394;">000-default.conf</span> e adicionar uma linha do com <i><u>ScriptAlias</u></i> nele, assim:<br /><br />{% highlight bash %}nano /etc/apache2/sites-available/000-default.conf{% endhighlight %}<br /><br />E adicione <u>ANTES</u> da tag &lt;/VirtualHost&gt; , o seguinte código:<br /><br />{% highlight bash %}ScriptAlias /sh/ /usr/lib/cgi-bin/{% endhighlight %}<br /><br />Salve-o e depois restarte o Apache:<br /><br />{% highlight bash %}systemctl restart apache2{% endhighlight %}<br /><br />Ou só releia o arquivo de configuração:<br /><br />{% highlight bash %}service apache2 reload{% endhighlight %}<br /><br />Depois é só criar um arquivo <u><i>teste</i></u>, exemplo o que vou disponibilizar aqui <u>abaixo</u>, salvá-lo no diretório <span style="color: blue;">/usr/lib/cgi-bin</span> e depois&nbsp; acessar o endereço <span style="color: blue;">http://localhost/cgi-bin/</span> ou <span style="color: purple;">http://localhost/sh/</span> , dependendo se vc criou <i>alias</i> do <u><i>Document Root</i></u> ou não, e ver se está tudo ok.<br /><br />Após salvar o arquivo, não esqueça de dar <u>permissão</u> de visualização para ele:<br /><br />{% highlight bash %}chmod a+x /usr/lib/cgi-bin/teste.cgi{% endhighlight %}<br /><br /><i><span style="font-size: x-large;">Arquivo <span style="background-color: black;"><span style="color: white;">teste.cgi</span></span>:</span></i><br /> <script src="https://gist.github.com/terminalrootsh/394912261766440e7db9.js"></script> </b><br /><b>&nbsp; <br />Qualquer dúvida, é só comentar.<br /><br />Abraços.<br /></b><span style="font-size: x-small;"><span style="color: #666666;"><i>Links úteis:</i></span></span><br /><span style="font-size: x-small;"><span style="color: #666666;"><i><br /></i></span></span><span style="font-size: x-small;"><span style="color: #666666;"><i>http://thobias.org/doc/cgi_shell.html </i></span></span><br /><span style="font-size: x-small;"><span style="color: #666666;"><i>http://www.vivaolinux.com.br/dica/Habilitar-CgiShell-no-Apache2 </i></span></span><br /><span style="font-size: x-small;"><span style="color: #666666;"><i>https://debian-handbook.info/browse/pt-BR/stable/sect.http-web-server.html </i></span></span><br /><span style="font-size: x-small;"><span style="color: #666666;"><i>http://httpd.apache.org/docs/current/howto/cgi.html</i></span></span>