---
layout: post
title: 'Curso Certificação Linux LPI-102:  Compartilhamento via Samba'
date: '2013-04-01T16:19:00.000-07:00'
description: 'Curso Certificação Linux LPI-102:  Compartilhamento via Samba'
main-class: 'linux'
color: '#3b5998'
author: The Bang Bash
tags:
- Linux
- LPI
modified_time: '2013-05-03T07:16:04.267-07:00'
thumbnail: http://2.bp.blogspot.com/-nxBUQohns4k/UVZAoKjJGbI/AAAAAAAABS8/cBn9_kWY_EI/s72-c/logo-samba1.jpg
twitter_text: 'Curso Certificação Linux LPI-102: Compartilhamento via Samba'
introduction: 'Curso Certificação Linux LPI-102: Compartilhamento via Samba'
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-nxBUQohns4k/UVZAoKjJGbI/AAAAAAAABS8/cBn9_kWY_EI/s1600/logo-samba1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-nxBUQohns4k/UVZAoKjJGbI/AAAAAAAABS8/cBn9_kWY_EI/s320/logo-samba1.jpg" /></a></div><!-------------------------------------------------> <script type="text/javascript"><!-- google_ad_client = "ca-pub-5528601613414387"; google_ad_host = "pub-1556223355139109"; /* quadrados */ google_ad_slot = "9713010559"; google_ad_width = 200; google_ad_height = 200; </script><script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript"></script><!-----------------------------------------------></p><p></p><p><b>Instale o protocolo samba:</b></p><p>{% highlight bash %}# apt-get install samba{% endhighlight %}</p><p></p><p><b>Por comando vc deve utilizar o comando tipo esse exemplo, supondo que o ip da máquina Windows seja 192.168.1.107:</b></p><p>{% highlight bash %}# smbclient -L 192.168.1.101 -U marcos{% endhighlight %}</p><p><b>Será listados os itens compartilhados, então você acessá-los com o comando simples:</b></p><p>{% highlight bash %}# mount -t smbfs //servidor/arquivos /mnt/smb{% endhighlight %}</p><p><b>Caso haja algum problema rode o comando {% highlight bash %}# testparm{% endhighlight %}, ele exibirá um dump das configurações após lhe solicitar um [enter].Nesse caso você deverá configurar um Samba com PDC (Primary Domain Controller, Controlador de Domínio Primário) , se tudo tiver certo exibirá um "ROLE_DOMAIN_PDC".Caso contrário configure o samba no arquivo</b> {% highlight bash %}# /etc/samba/smb.conf{% endhighlight %} <b>com as configurações tipo do exemplo abaixo:</b></p><p>{% highlight bash %}[global]</p><p>netbios name = SERVIDOR</p><p>workgroup = DOMINIO</p><p>server string = Samba %v</p><p>dns proxy = no</p><p>log file = /var/log/samba/log.%m</p><p>max log size = 1000</p><p>syslog = 0</p><p>panic action = /usr/share/samba/panic-action %d</p><p>domain master = yes</p><p>domain logons = yes</p><p>preferred master = yes</p><p>logon path =</p><p>os level = 33</p><p>wins support = yes{% endhighlight %}</p><p></p><p></p><p><b>Por modo gráfico, abra o Nautilus (uma pasta qualquer no seu Linux) e aperte Ctrl+L e digite:</b></p><p>{% highlight bash %}smb://192.168.1.107{% endhighlight %}<b>e navegue nos itens compartilhados.</b></p><p></p><p><b>Os acessos as pastas e arquivos do Windows vão depender das configurações efetuadas no Windows:</b></p><p><b>-se as pastas estão compartilhadas</b></p><p><b>-se está para solicitar senha</b></p><p><b>-...</b></p><p></p><p><b>Além desse pacote, voçê pode, se quiser, instalar outros que te ajudem caso precise de acessos e configurações do Samba em modo gráfico, dessa forma voçê pode instalar esse conjunto abaixo:</b></p><p>{% highlight bash %}# apt-get install samba smbclient swat samba-doc{% endhighlight %}</p><p></p><p><b>O script de instalação faz duas perguntas. A primeira é se o servidor deve rodar em modo daemon ou sob o inetd. Responda "daemons" para que o servidor rode diretamente. Isso garante um melhor desempenho, melhor segurança e evita problemas diversos de configuração relacionados ao uso do inetd, serviço que está entrando em desuso.</b></p><p></p><p><b>Em seguida ele pergunta: "Gerar a base de dados para senhas /var/lib/samba/passdb.tdb?". É importante responder que "Sim", para que ele crie o arquivo onde serão armazenadas as senhas de acesso. Como explica o script, "Caso você não o crie, você terá que reconfigurar o samba (e provavelmente suas máquinas clientes) para utilização de senhas em texto puro", o que é um procedimento trabalhoso, que consiste em modificar chaves de registro em todas as máquinas Windows da rede e modificar a configuração de outros servidores Linux. Muito mais fácil responder "Sim" e deixar que ele utilize senhas encriptadas, que é o padrão. :)</b></p><p></p><p><b>Com os pacotes instalados, use os comandos:</b></p><p>{% highlight bash %}# /etc/init.d/samba start</p><p># /etc/init.d/samba stop{% endhighlight %}</p><p></p><p><b>... para iniciar e parar o serviço. Por padrão, ao instalar o pacote é criado um link na pasta "/etc/rc5.d", que ativa o servidor automaticamente durante o boot. Para desativar a inicialização automática, use o comando</b>:</p><p>{% highlight bash %}# update-rc.d -f samba remove{% endhighlight %}</p><p></p><p><b>Para reativá-lo mais tarde, use:</b></p><p>{% highlight bash %}# update-rc.d -f samba defaults{% endhighlight %}</p><p><b></p><p></b></p><p><b>Você pode verificar qual é a versão do Samba instalada usando o comando "smbd -V", como em:</b></p><p>{% highlight bash %}# smbd -V{% endhighlight %}</p><p></p><p><b>Para compartilhar pastas do Linux na rede, você pode utilizar o Swat, para isso voçê deve criar um usuário samba antes e liberar a porta do serviço para acesso pelo browser, para criar um usuario samba, ativar a porta 901 do localhost , segue respectivamente os comandos abaixo, mais informações dos comandos use o "man comando", aqui é só uma luz para você poder utilizar:</b></p><p></p><p><b>Logar no swat:</b></p><p>{% highlight bash %}# smbpasswd -a marcos</p><p>http://127.0.0.1:901/(No seu navegador, será solicitada a senha do samba, se não houver use do seu usuário para acesso ao seu Linux){% endhighlight %}</p><p></p><p><b>Para que a alteração efetuada no Swat entre em vigor, reinicie o inetd com o comando:</b></p><p>{% highlight bash %}# /etc/init.d/inetd restart{% endhighlight %}</p><p></p><p><b>Obs.:O Swat não usa encriptação de senha, ou seja, se alguém sniffar sua conexão, verá sua senha nos pacotes do TCP/IP, para que isso não ocorra voçê pode acessá-lo pelo túnel SSH, da seguinte forma:</b></p><p>{% highlight bash %}# ssh -f -N -L901:192.168.1.107:901 -l login 192.168.1.107{% endhighlight %}</p><p><b>Para criar compartilhamento use o shares:</b></p><p>{% highlight bash %}http://127.0.0.1:901/shares{% endhighlight %}</p><p></p><p><b>Por enquanto é só, até a próxima!</b>

</p>
