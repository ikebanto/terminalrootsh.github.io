---
layout: post
title: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
date: '2014-09-02T20:20:00.000-07:00'
description: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
main-class: 'bash'
color: '#c2003a'
author: Marcos Oliveira
tags:
- Shell Script
- Dicas
modified_time: '2014-09-02T20:20:33.140-07:00'
thumbnail: http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s72-c/optimizing-shell-scripts.jpg
twitter_text: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
introduction: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s1600/optimizing-shell-scripts.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s320/optimizing-shell-scripts.jpg" /></a></div><b>Iniciar uma aplicações em <span style="color: blue;">bash script</span> geralmente é uma tarefa chata. Tem que parsear argumentos, tratar valores, etc. Eu iniciei um projeto para criar um <span style="color: blue;">framework</span> para desenvolvimento de aplicações escritas em <span style="color: blue;">Shell Script</span>.</p><p></p><p>Com o framework, quero tentar trazer uma forma mais organizada de se programar em Shell Script. Muitos dos scripts que são vistos por aí, acabam sendo códigos mal identados e confusos.</p><p></b></p><p><blockquote class="tr_bq"><b>O framework está disponível num repositório no <a href="https://github.com/bellthoven/bangsh" target="_blank"><span style="color: blue; font-size: large;">GitHub</span></a>. Se você se sentir a vontade, pode contribuir ! Todas contribuições são bem vindas. Se algum bug for encontrado, reporte, por favor! Assim poderemos tornar o framework mais estável e útil.</b></blockquote><b></p><p>O uso dele é bem simples. Por hora, ainda não faz muitas coisas, mas já quebra o galho !</p><p></p><p>A funcionalidade mais importante dele agora é o parseador de parâmetros. Vamos fazer um exemplo:</b></p><p><div class="adp"><b></p><p></b><b>#!/bin/sh</b></p><p><b># app.sh</b></p><p><b>source ./bang.sh</b></p><p><b></p><p></b><b># Help flag</b></p><p><b>bang_addflag --help "Show this help"</b></p><p><b>bang_addalias --help -h</b></p><p><b># Message</b></p><p><b>bang_addopt --msg "Message to be printed!"</b></p><p><b>bang_addalias --msg -m</b></p><p><b># Output</b></p><p><b>bang_addflag --stderr "Redirects the message to stderr"</b></p><p><b></p><p></b><b>bang_required_args "--msg"</b></p><p><b></p><p></b><b>bang_init "$@"</b></p><p><b></p><p></b><b>if bang_hasflag --help; then</b></p><p><b>&nbsp;&nbsp;&nbsp; bang_show_usage</b></p><p><b>else</b></p><p><b>&nbsp;&nbsp;&nbsp; bang_check_required_args</b></p><p><b>&nbsp;&nbsp;&nbsp; msg="Your message is: $(bang_getopt --msg)"</b></p><p><b>&nbsp;&nbsp;&nbsp; cmd="echo"</b></p><p><b>&nbsp;&nbsp;&nbsp; bang_hasflag --stderr &amp;&amp; cmd="print_e"</b></p><p><b>&nbsp;&nbsp;&nbsp; $cmd "$msg"</b></p><p><b>fi</b></div><b></p><p>No script acima são adicionadas 3 argumentos ao arquivo: <span style="color: purple;"><i>--help</i></span> ou <i><span style="color: purple;">-h</span></i>, <span style="color: purple;"><i>--msg</i></span> ou <span style="color: purple;"><i>-m</i></span> e <i><span style="color: purple;">--strderr</span></i>. Veja agora o output segundo a combinação de alguns parâmetros:</p><p></p><p>Sem argumentos, o programa deve verificar pelos argumentos requeridos</b></p><p><div class="adp"><b></p><p></b><b>$ ./app.sh</b></div><b></p><p>The program was aborted due an error:</b></p><p><blockquote class="tr_bq"><b>&nbsp;&nbsp;&nbsp; Option '--msg' is required and was not specified</b></blockquote><b></p><p>Mostrando o texto de ajuda automaticamente montado</b></p><p><div class="adp"><b></p><p></b><b>$ ./app.sh -h # ou ./app.sh --help</b></div><b></p><p>Showing script usage:</p><p></p><p>Options:</p><p><div class="adp"></p><p>--msg|-m &lt;value&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (Required) Message to be printed!</div></p><p>Flags:</p><p><div class="adp"></p><p>--help|-h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Show this help</p><p>--stderr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Redirects the message to stderr</p><p>&lt;/value&gt;</div></p><p>Imprime a mensagem no <span style="background-color: black;"><span style="color: white;">STDOUT</span></span></p><p><div class="adp"></p><p>$ ./app.sh --msg "Hello World" # ou ./app.sh -m "Hello World"</div></p><p>Your message is: Hello World</p><p></p><p>Imprime a mensagem no <span style="background-color: black;"><span style="color: white;">STDERR</span></span></p><p><div class="adp"></p><p>$ ./app.sh --msg "Hello World" --stderr 1&gt;/dev/null</div></p><p><i><u>Your message is: Hello World</u></i></p><p></p><p>Além destas, há outras funções úteis, como o <span style="color: blue;">bang_raise_error</span> que dispara um erro (e mostra no <span style="color: purple;">STDERR</span>) formatado com um padrão e dá <span style="color: purple;">exit 2</span>.</p><p><span style="color: purple;">bang_raise_error</span> "Mensagem de erro"</p><p></p><p>Há também a função para imprimir no <span style="color: blue;">STDERR</span>.</p><p>print_e "Mensagem que irá para para o <span style="color: blue;">STDERR</span>"</p><p></p><p>Funções úteis como o <span style="color: blue;">in_array</span> e <span style="color: blue;">key_exists</span> para se trabalhar com arrays.</p><p><div class="adp"></p><p>A=(A B C)</p><p>in_array "B" "A" &amp;&amp; echo "B está em \$A"</p><p></p><p>declare -A A=(["name"]="Gustavo Dutra")</p><p>key_exists "name" "A" &amp;&amp; echo "name é chave de \$A"</div></p><p></p><p>Por enquanto é isto! Bons scripts! Qualquer dúvida, pode comentar aqui !</p><p></p><p></p><p>Via: <a href="http://gustavodutra.com/" target="_blank">http://gustavodutra.com</a></b>

</p>
