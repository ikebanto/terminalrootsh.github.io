---
layout: post
title: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
date: '2014-09-02T20:20:00.000-07:00'
description: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
main-class: 'bash'
color: '#c2003a'
author: Marcos Oliveira
tags:
- Shell Script
- Dicas
modified_time: '2014-09-02T20:20:33.140-07:00'
thumbnail: http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s72-c/optimizing-shell-scripts.jpg
twitter_text: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
introduction: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s1600/optimizing-shell-scripts.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s320/optimizing-shell-scripts.jpg" /></a></div><b>Iniciar uma aplicações em <span style="color: blue;">bash script</span> geralmente é uma tarefa chata. Tem que parsear argumentos, tratar valores, etc. Eu iniciei um projeto para criar um <span style="color: blue;">framework</span> para desenvolvimento de aplicações escritas em <span style="color: blue;">Shell Script</span>.<br /><br />Com o framework, quero tentar trazer uma forma mais organizada de se programar em Shell Script. Muitos dos scripts que são vistos por aí, acabam sendo códigos mal identados e confusos.<br /></b><br /><blockquote class="tr_bq"><b>O framework está disponível num repositório no <a href="https://github.com/bellthoven/bangsh" target="_blank"><span style="color: blue; font-size: large;">GitHub</span></a>. Se você se sentir a vontade, pode contribuir ! Todas contribuições são bem vindas. Se algum bug for encontrado, reporte, por favor! Assim poderemos tornar o framework mais estável e útil.</b></blockquote><b><br />O uso dele é bem simples. Por hora, ainda não faz muitas coisas, mas já quebra o galho !<br /><br />A funcionalidade mais importante dele agora é o parseador de parâmetros. Vamos fazer um exemplo:</b><br /><div class="adp"><b><br /></b><b>#!/bin/sh</b><br /><b># app.sh</b><br /><b>source ./bang.sh</b><br /><b><br /></b><b># Help flag</b><br /><b>bang_addflag --help "Show this help"</b><br /><b>bang_addalias --help -h</b><br /><b># Message</b><br /><b>bang_addopt --msg "Message to be printed!"</b><br /><b>bang_addalias --msg -m</b><br /><b># Output</b><br /><b>bang_addflag --stderr "Redirects the message to stderr"</b><br /><b><br /></b><b>bang_required_args "--msg"</b><br /><b><br /></b><b>bang_init "$@"</b><br /><b><br /></b><b>if bang_hasflag --help; then</b><br /><b>&nbsp;&nbsp;&nbsp; bang_show_usage</b><br /><b>else</b><br /><b>&nbsp;&nbsp;&nbsp; bang_check_required_args</b><br /><b>&nbsp;&nbsp;&nbsp; msg="Your message is: $(bang_getopt --msg)"</b><br /><b>&nbsp;&nbsp;&nbsp; cmd="echo"</b><br /><b>&nbsp;&nbsp;&nbsp; bang_hasflag --stderr &amp;&amp; cmd="print_e"</b><br /><b>&nbsp;&nbsp;&nbsp; $cmd "$msg"</b><br /><b>fi</b></div><b><br />No script acima são adicionadas 3 argumentos ao arquivo: <span style="color: purple;"><i>--help</i></span> ou <i><span style="color: purple;">-h</span></i>, <span style="color: purple;"><i>--msg</i></span> ou <span style="color: purple;"><i>-m</i></span> e <i><span style="color: purple;">--strderr</span></i>. Veja agora o output segundo a combinação de alguns parâmetros:<br /><br />Sem argumentos, o programa deve verificar pelos argumentos requeridos</b><br /><div class="adp"><b><br /></b><b>$ ./app.sh</b></div><b><br />The program was aborted due an error:</b><br /><blockquote class="tr_bq"><b>&nbsp;&nbsp;&nbsp; Option '--msg' is required and was not specified</b></blockquote><b><br />Mostrando o texto de ajuda automaticamente montado</b><br /><div class="adp"><b><br /></b><b>$ ./app.sh -h # ou ./app.sh --help</b></div><b><br />Showing script usage:<br /><br />Options:<br /><div class="adp"><br />--msg|-m &lt;value&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (Required) Message to be printed!</div><br />Flags:<br /><div class="adp"><br />--help|-h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Show this help<br />--stderr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Redirects the message to stderr<br />&lt;/value&gt;</div><br />Imprime a mensagem no <span style="background-color: black;"><span style="color: white;">STDOUT</span></span><br /><div class="adp"><br />$ ./app.sh --msg "Hello World" # ou ./app.sh -m "Hello World"</div><br />Your message is: Hello World<br /><br />Imprime a mensagem no <span style="background-color: black;"><span style="color: white;">STDERR</span></span><br /><div class="adp"><br />$ ./app.sh --msg "Hello World" --stderr 1&gt;/dev/null</div><br /><i><u>Your message is: Hello World</u></i><br /><br />Além destas, há outras funções úteis, como o <span style="color: blue;">bang_raise_error</span> que dispara um erro (e mostra no <span style="color: purple;">STDERR</span>) formatado com um padrão e dá <span style="color: purple;">exit 2</span>.<br /><span style="color: purple;">bang_raise_error</span> "Mensagem de erro"<br /><br />Há também a função para imprimir no <span style="color: blue;">STDERR</span>.<br />print_e "Mensagem que irá para para o <span style="color: blue;">STDERR</span>"<br /><br />Funções úteis como o <span style="color: blue;">in_array</span> e <span style="color: blue;">key_exists</span> para se trabalhar com arrays.<br /><div class="adp"><br />A=(A B C)<br />in_array "B" "A" &amp;&amp; echo "B está em \$A"<br /><br />declare -A A=(["name"]="Gustavo Dutra")<br />key_exists "name" "A" &amp;&amp; echo "name é chave de \$A"</div><br /><br />Por enquanto é isto! Bons scripts! Qualquer dúvida, pode comentar aqui !<br /><br /><br />Via: <a href="http://gustavodutra.com/" target="_blank">http://gustavodutra.com</a></b>