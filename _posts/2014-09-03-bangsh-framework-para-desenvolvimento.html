---
layout: post
title: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
date: '2014-09-02T20:20:00.000-07:00'
description: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
main-class: 'bash'
color: '#c2003a'
author: Marcos Oliveira
tags:
- Shell Script
- Dicas
modified_time: '2014-09-02T20:20:33.140-07:00'
thumbnail: http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s72-c/optimizing-shell-scripts.jpg
twitter_text: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
introduction: Bang.sh - Framework para desenvolvimento de aplicações em Shell Script
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s1600/optimizing-shell-scripts.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-hGgmwI6aZzc/VAaIbZTQg-I/AAAAAAAAAqg/PhDq-tASqGs/s320/optimizing-shell-scripts.jpg" /></a></div><b>Iniciar uma aplicações em <span style="color: blue;">bash script</span> geralmente é uma tarefa chata. Tem que parsear argumentos, tratar valores, etc. Eu iniciei um projeto para criar um <span style="color: blue;">framework</span> para desenvolvimento de aplicações escritas em <span style="color: blue;">Shell Script</span>.

Com o framework, quero tentar trazer uma forma mais organizada de se programar em Shell Script. Muitos dos scripts que são vistos por aí, acabam sendo códigos mal identados e confusos.
</b>
<blockquote class="tr_bq"><b>O framework está disponível num repositório no <a href="https://github.com/bellthoven/bangsh" target="_blank"><span style="color: blue; font-size: large;">GitHub</span></a>. Se você se sentir a vontade, pode contribuir ! Todas contribuições são bem vindas. Se algum bug for encontrado, reporte, por favor! Assim poderemos tornar o framework mais estável e útil.</b></blockquote><b>
O uso dele é bem simples. Por hora, ainda não faz muitas coisas, mas já quebra o galho !

A funcionalidade mais importante dele agora é o parseador de parâmetros. Vamos fazer um exemplo:</b>
<div class="adp"><b>
</b><b>#!/bin/sh</b>
<p># app.sh</p>
<p>source ./bang.sh</p>
<b>
</b><b># Help flag</b>
<p>bang_addflag --help "Show this help"</p>
<p>bang_addalias --help -h</p>
<p># Message</p>
<p>bang_addopt --msg "Message to be printed!"</p>
<p>bang_addalias --msg -m</p>
<p># Output</p>
<p>bang_addflag --stderr "Redirects the message to stderr"</p>
<b>
</b><b>bang_required_args "--msg"</b>
<b>
</b><b>bang_init "$@"</b>
<b>
</b><b>if bang_hasflag --help; then</b>
<p> bang_show_usage</p>
<p>else</p>
<p> bang_check_required_args</p>
<p> msg="Your message is: $(bang_getopt --msg)"</p>
<p> cmd="echo"</p>
<p> bang_hasflag --stderr &amp;&amp; cmd="print_e"</p>
<p> $cmd "$msg"</p>
<b>fi</b></div><b>
No script acima são adicionadas 3 argumentos ao arquivo: <span style="color: purple;"><i>--help</i></span> ou <i><span style="color: purple;">-h</span></i>, <span style="color: purple;"><i>--msg</i></span> ou <span style="color: purple;"><i>-m</i></span> e <i><span style="color: purple;">--strderr</span></i>. Veja agora o output segundo a combinação de alguns parâmetros:

Sem argumentos, o programa deve verificar pelos argumentos requeridos</b>
<div class="adp"><b>
</b><b>$ ./app.sh</b></div><b>
The program was aborted due an error:</b>
<blockquote class="tr_bq"><b> Option '--msg' is required and was not specified</b></blockquote><b>
Mostrando o texto de ajuda automaticamente montado</b>
<div class="adp"><b>
</b><b>$ ./app.sh -h # ou ./app.sh --help</b></div><b>
Showing script usage:

Options:
<div class="adp">
--msg|-m <value> (Required) Message to be printed!</div>
Flags:
<div class="adp">
--help|-h Show this help
--stderr Redirects the message to stderr
</value></div>
Imprime a mensagem no <span style="background-color: black;"><span style="color: white;">STDOUT</span></span>
<div class="adp">
$ ./app.sh --msg "Hello World" # ou ./app.sh -m "Hello World"</div>
Your message is: Hello World

Imprime a mensagem no <span style="background-color: black;"><span style="color: white;">STDERR</span></span>
<div class="adp">
$ ./app.sh --msg "Hello World" --stderr 1>/dev/null</div>
<i><u>Your message is: Hello World</u></i>

Além destas, há outras funções úteis, como o <span style="color: blue;">bang_raise_error</span> que dispara um erro (e mostra no <span style="color: purple;">STDERR</span>) formatado com um padrão e dá <span style="color: purple;">exit 2</span>.
<span style="color: purple;">bang_raise_error</span> "Mensagem de erro"

Há também a função para imprimir no <span style="color: blue;">STDERR</span>.
print_e "Mensagem que irá para para o <span style="color: blue;">STDERR</span>"

Funções úteis como o <span style="color: blue;">in_array</span> e <span style="color: blue;">key_exists</span> para se trabalhar com arrays.
<div class="adp">
A=(A B C)
in_array "B" "A" &amp;&amp; echo "B está em \$A"

declare -A A=(["name"]="Gustavo Dutra")
key_exists "name" "A" &amp;&amp; echo "name é chave de \$A"</div>

Por enquanto é isto! Bons scripts! Qualquer dúvida, pode comentar aqui !


Via: <a href="http://gustavodutra.com/" target="_blank">http://gustavodutra.com</a></b>

</p>
