---
layout: post
title: 'Função Shell Script (Bash): Procura o CEP pelo nome da rua, cidade e UF informados'
date: '2014-09-06T19:19:00.000-07:00'
author: Marcos Oliveira
tags:
- Shell Script
- AWK
- SED
modified_time: '2014-10-28T15:49:16.438-07:00'
thumbnail: http://1.bp.blogspot.com/-6k6Mx5CNwuc/Ur9FmBGo9aI/AAAAAAAAAHM/VVA_zbTxQes/s72-c/correios-shell.jpg
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-7553308617145003623
blogger_orig_url: http://www.terminalroot.com.br/2014/09/funcao-shell-script-bash-procura-o-cep.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-6k6Mx5CNwuc/Ur9FmBGo9aI/AAAAAAAAAHM/VVA_zbTxQes/s1600/correios-shell.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-6k6Mx5CNwuc/Ur9FmBGo9aI/AAAAAAAAAHM/VVA_zbTxQes/s1600/correios-shell.jpg" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><span style="font-family: Verdana,sans-serif;"><span style="color: #444444;"><span style="font-size: large;"><b><span style="color: blue;">Procura o CEP</span> pelo nome da <span style="color: purple;">rua</span>, <span style="color: purple;">cidade</span> e <span style="color: purple;">UF</span> informados  Segue o how to que ensina como utilizá-la, que por sinal é bem simples, que também é o cabeçalho e a opção <span style="color: blue;"><span style="font-size: x-large;">cep2rua</span></span> <span style="color: #073763;"><i>--help</i></span></b></span></span></span><br /><br /><blockquote class="tr_bq"><span style="color: purple;"><i><b>Função Shell Script (Bash): Procura o CEP pelo nome da rua, cidade e UF informados</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;-h (exibe ajuda, cabeçalho da função)</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;-e (exibe o endereço completo)</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;Obs.: As opções (parâmetro: -h ou --help ; -e ou --endereco)</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , se forem utilizadas, o -h não recebe complementp.</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;e o -e ou --endereco , deve ser utilizado antes de </b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;digitar o endereço.</b></i></span><br /><span style="color: purple;"><i><b><br /></b></i></span><span style="color: purple;"><i><b>&nbsp;Usos:&nbsp;&nbsp; &nbsp;cep2rua [rua cidade uf]</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;cep2rua [-e] [rua cidade uf]</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;cep2rua [--endereco] [rua cidade uf]</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;cep2rua [-h]</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;cep2rua [--help]</b></i></span><br /><span style="color: purple;"><i><b><br /></b></i></span><span style="color: purple;"><i><b>&nbsp;Exs.: cep2rua rua santana salvador ba</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cep2rua -e rua rio da ilha salvador ba</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cep2rua rua cambui londrina pr</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;cep2rua rua silverio lelis sao paulo sp</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cep2rua -e jobim rio de janeiro rj</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;&nbsp;&nbsp;&nbsp; </b></i></span><br /><span style="color: purple;"><i><b>&nbsp;Autor:Marcos da B. M. Oliveira , http://www.terminalroot.com.br/</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;Desde: 2013-12-28</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;Versão: 1</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;Licença: GPL</b></i></span><br /><span style="color: purple;"><i><b>&nbsp;Requisitos:</b></i></span></blockquote><br /><br /><a href="http://pastebin.com/RCx8LSdg" target="_blank"><b><span style="font-size: x-large;">Código no PasteBin</span></b></a>: <br /><script src="http://pastebin.com/embed_js.php?i=5AL1fkEZ"></script> <br /><b>Código no Blog: </b><br /><div class="adp"><b>#!/bin/bash<br /># ----------------------------------------------------------------------------<br /># Função Shell Script (Bash): Procura o CEP pelo nome da rua, cidade e UF informados<br /># AWK, SED, Shell Script, <br /># -h (exibe ajuda, cabeçalho da função)<br /># -e (exibe o endereço completo)<br /># Obs.: As opções (parâmetro: -h ou --help ; -e ou --endereco)<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , se forem utilizadas, o -h não recebe complementp.<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; e o -e ou --endereco , deve ser utilizado antes de <br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; digitar o endereço.<br />#<br /># Usos:&nbsp;&nbsp;&nbsp; cep2rua [rua cidade uf]<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cep2rua [-e] [rua cidade uf]<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cep2rua [--endereco] [rua cidade uf]<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cep2rua [-h]<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cep2rua [--help]<br />#<br /># Exs.: cep2rua rua santana salvador ba<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua -e rua rio da ilha salvador ba<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua rua cambui londrina pr<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; cep2rua rua silverio lelis sao paulo sp<br />#&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua -e jobim rio de janeiro rj<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /># Autor:Marcos da B. M. Oliveira , http://www.terminalroot.com.br/<br /># Desde: 2013-12-28<br /># Versão: 1<br /># Licença: GPL<br /># Requisitos: lynx ( se vc não tiver ele instalado, instale: apt-get install lynx )<br /># ----------------------------------------------------------------------------<br />cep2rua(){<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$*" ]; then<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -n<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Sem parâmetros, digite o endereço."<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$(which lynx)" ]; then<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -n "";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "o lynx não está instaldo, instale com:<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; apt-get install lynx<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Abortar."<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # variavel do que for digitado<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; local endereco="$*"<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # troca os espaços em branco por '+' para efetuar pesquisa<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; local endereco="$(echo $endereco | sed -e 's/ /+/g')"<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # endereço para pesquisa<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; local urlendereco="http://maps.google.com/maps/api/geocode/json?address=$*&amp;sensor=false"<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # baixa o código fonte do arquivo pesquisado<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; local endcom="$(lynx -source "$urlendereco" |<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # imprime só a linha que contém a palavra 'formatted_address'<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed -n '/formatted_address/p' |<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # divide a linha anterior em duas, após o sinal de ': '<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed 's/: /: \n/' |<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # deleta a linha que contém a string 'formatted_address'<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed '/formatted_address/d' |<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; # troca todas as ocorrências de \"(aspas duplas) e de ,(vírgula) por nada, e imprime o endereço.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed 's/\"\|\,//g')"<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case $1 in<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -h | --help)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Usos:<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua [rua cidade uf]<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua [-e] [rua cidade uf]<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua [--endereco] [rua cidade uf]<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua [-h]<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua [--help]<br /><br />&nbsp;Exs.: <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua rua santana salvador ba<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua -e rua rio da ilha salvador ba<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua rua cambui londrina pr<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua rua silverio lelis sao paulo sp<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cep2rua -e jobim rio de janeiro rj"<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; shift<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ;;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -e | endereco)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "$endcom";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; shift<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ;;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; local cep=$(echo $endcom | tr -d -c 0123456789)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$cep" = "" ]; then<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Cep não encontrado";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "$(echo $cep | cut -c1-5)-$(echo $cep | cut -c6-8)"; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ;;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; esac<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0<br />}<br />cep2rua "$@" </b></div>