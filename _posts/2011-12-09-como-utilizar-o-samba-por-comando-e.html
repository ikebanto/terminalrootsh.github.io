---
layout: post
title: Como utilizar o Samba por comando e modo gráfico
date: '2011-12-09T15:56:00.000-08:00'
author: The Bang Bash
tags:
- Debian
- Linux
- Redes
modified_time: '2013-05-03T07:16:09.098-07:00'
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-8963908579040421165
blogger_orig_url: http://www.terminalroot.com.br/2011/12/como-utilizar-o-samba-por-comando-e.html
---

<b>Instale o protocolo samba:</b><br />{% highlight bash %}# apt-get install samba{% endhighlight %}<br /><br /><b>Por comando vc deve utilizar o comando tipo esse exemplo, supondo que o ip da máquina Windows seja 192.168.1.107:</b><br />{% highlight bash %}# smbclient -L 192.168.1.101 -U marcos{% endhighlight %}<br /><b>Será listados os itens compartilhados, então você acessá-los com o comando simples:</b><br />{% highlight bash %}# mount -t smbfs //servidor/arquivos /mnt/smb{% endhighlight %}<br /><b>Caso haja algum problema rode o comando {% highlight bash %}# testparm{% endhighlight %}, ele exibirá um dump das configurações após lhe solicitar um [enter].Nesse caso você deverá configurar um Samba com PDC (Primary Domain Controller, Controlador de Domínio Primário) , se tudo tiver certo exibirá um "ROLE_DOMAIN_PDC".Caso contrário configure o samba no arquivo</b> {% highlight bash %}# /etc/samba/smb.conf{% endhighlight %} <b>com as configurações tipo do exemplo abaixo:</b><br />{% highlight bash %}[global]<br />netbios name = SERVIDOR<br />workgroup = DOMINIO<br />server string = Samba %v<br />dns proxy = no<br />log file = /var/log/samba/log.%m<br />max log size = 1000<br />syslog = 0<br />panic action = /usr/share/samba/panic-action %d<br />domain master = yes<br />domain logons = yes<br />preferred master = yes<br />logon path =<br />os level = 33<br />wins support = yes{% endhighlight %}<br /><br /><br /><b>Por modo gráfico, abra o Nautilus (uma pasta qualquer no seu Linux) e aperte Ctrl+L e digite:</b><br />{% highlight bash %}smb://192.168.1.107{% endhighlight %}<b>e navegue nos itens compartilhados.</b><br /><br /><b>Os acessos as pastas e arquivos do Windows vão depender das configurações efetuadas no Windows:</b><br /><b>-se as pastas estão compartilhadas</b><br /><b>-se está para solicitar senha</b><br /><b>-...</b><br /><br /><b>Além desse pacote, voçê pode, se quiser, instalar outros que te ajudem caso precise de acessos e configurações do Samba em modo gráfico, dessa forma voçê pode instalar esse conjunto abaixo:</b><br />{% highlight bash %}# apt-get install samba smbclient swat samba-doc{% endhighlight %}<br /><br /><b>O script de instalação faz duas perguntas. A primeira é se o servidor deve rodar em modo daemon ou sob o inetd. Responda "daemons" para que o servidor rode diretamente. Isso garante um melhor desempenho, melhor segurança e evita problemas diversos de configuração relacionados ao uso do inetd, serviço que está entrando em desuso.</b><br /><br /><b>Em seguida ele pergunta: "Gerar a base de dados para senhas /var/lib/samba/passdb.tdb?". É importante responder que "Sim", para que ele crie o arquivo onde serão armazenadas as senhas de acesso. Como explica o script, "Caso você não o crie, você terá que reconfigurar o samba (e provavelmente suas máquinas clientes) para utilização de senhas em texto puro", o que é um procedimento trabalhoso, que consiste em modificar chaves de registro em todas as máquinas Windows da rede e modificar a configuração de outros servidores Linux. Muito mais fácil responder "Sim" e deixar que ele utilize senhas encriptadas, que é o padrão. :)</b><br /><br /><b>Com os pacotes instalados, use os comandos:</b><br />{% highlight bash %}# /etc/init.d/samba start<br /># /etc/init.d/samba stop{% endhighlight %}<br /><br /><b>... para iniciar e parar o serviço. Por padrão, ao instalar o pacote é criado um link na pasta "/etc/rc5.d", que ativa o servidor automaticamente durante o boot. Para desativar a inicialização automática, use o comando</b>:<br />{% highlight bash %}# update-rc.d -f samba remove{% endhighlight %}<br /><br /><b>Para reativá-lo mais tarde, use:</b><br />{% highlight bash %}# update-rc.d -f samba defaults{% endhighlight %}<br /><b><br /></b><br /><b>Você pode verificar qual é a versão do Samba instalada usando o comando "smbd -V", como em:</b><br />{% highlight bash %}# smbd -V{% endhighlight %}<br /><br /><b>Para compartilhar pastas do Linux na rede, você pode utilizar o Swat, para isso voçê deve criar um usuário samba antes e liberar a porta do serviço para acesso pelo browser, para criar um usuario samba, ativar a porta 901 do localhost , segue respectivamente os comandos abaixo, mais informações dos comandos use o "man comando", aqui é só uma luz para você poder utilizar:</b><br /><br /><b>Logar no swat:</b><br />{% highlight bash %}# smbpasswd -a marcos<br />http://127.0.0.1:901/(No seu navegador, será solicitada a senha do samba, se não houver use do seu usuário para acesso ao seu Linux){% endhighlight %}<br /><br /><b>Para que a alteração efetuada no Swat entre em vigor, reinicie o inetd com o comando:</b><br />{% highlight bash %}# /etc/init.d/inetd restart{% endhighlight %}<br /><br /><b>Obs.:O Swat não usa encriptação de senha, ou seja, se alguém sniffar sua conexão, verá sua senha nos pacotes do TCP/IP, para que isso não ocorra voçê pode acessá-lo pelo túnel SSH, da seguinte forma:</b><br />{% highlight bash %}# ssh -f -N -L901:192.168.1.107:901 -l login 192.168.1.107{% endhighlight %}<br /><b>Para criar compartilhamento use o shares:</b><br />{% highlight bash %}http://127.0.0.1:901/shares{% endhighlight %}<br /><br /><b>Por enquanto é só, até a próxima!</b>