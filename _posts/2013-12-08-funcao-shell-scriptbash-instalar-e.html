---
layout: post
title: 'Função Shell Script(Bash): Instalar e Configurar o NFS'
date: '2013-12-08T14:37:00.002-08:00'
author: Marcos Oliveira
tags:
- Linux
- Shell Script
- Servidores
- Redes
modified_time: '2014-10-28T15:44:51.037-07:00'
thumbnail: http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s72-c/shell+script2.png
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-6816379917750235134
blogger_orig_url: http://www.terminalroot.com.br/2013/12/funcao-shell-scriptbash-instalar-e.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s1600/shell+script2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s320/shell+script2.png" /></a></div><br /><blockquote class="tr_bq"><b><span style="color: purple;">* Função Shell Script(Bash): Instalar e Configurar o NFS</span></b><br /><span style="color: purple;"><b></b></span><span style="color: purple;"><b>* Você (pode e deve) customizá-lo para sua instalação, por exemplo:</b></span><br /><span style="color: purple;"><b>* o user root foi só um exemplo;</b></span><br /><span style="color: purple;"><b>&nbsp; </b></span><br /><span style="color: purple;"><b>* o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;</b></span><br /><span style="color: purple;"><b>&nbsp; altere, caso queira ao seu gosto.</b></span><br /><span style="color: purple;"><b></b></span><span style="color: purple;"><b>* Uso: ./installNFS </b></span></blockquote><b><br /><span style="color: blue;"><span style="font-size: large;">Codigo no PasteBin:</span></span><br /><br /><script src="http://pastebin.com/embed_js.php?i=kuQ8S3kJ"></script> <br /><span style="color: purple;"><span style="font-size: x-large;">Código no Blog:</span></span><br /><br /></b><br /><div class="adp"><b>#!/bin/bash</b><br /><b># --------------------------------------</b><br /><b># ./installNFS</b><br /><b>#</b><br /><b># Função Shell Script(Bash): Instalar e Configurar o NFS</b><br /><b>#</b><br /><b># Você (pode e deve) customizá-lo para sua instalação, por exemplo:</b><br /><b># o user root foi só um exemplo;</b><br /><b># </b><br /><b># o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;</b><br /><b># altere, caso queira ao seu gosto.</b><br /><b>#</b><br /><b># Uso: ./installNFS</b><br /><b>AJUDA="Exemplo:</b><br /><b>SINOPSE</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ./installNFS [OPÇÕES]</b><br /><b><br /></b><b>DESCRIÇÃO</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Função Shell Script(Bash): Instalar e Configurar o NFS</b><br /><b><br /></b><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -h, --help</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NFS é um protocolo de sistema de arquivos para compartilhamento entre arquivos e diretórios entre computadores </b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conectados em rede.è com NFS que é feito o acesso, existem outras formas, mas certifique-se que essa é a mais simples e a melhor.</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Como instalar o NFS em: http://www.terminalroot.com.br/2011/11/compartilhando-pasta-do-linux-para.html.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "</b><br /><b>ENTRAR="</b><br /><b>-e, --enter</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp; 1) Você pode montar a pasta com: mount -t nfs IP:caminho_da_pasta </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp; 2) Caso não consiga o acesso, lembre-se de dar permissões locais com o 'chmod'."</b><br /><b>CONF="</b><br /><b>-c, --conf</b><br /><b>&nbsp;&nbsp;&nbsp; 'rw' permissão de leitura(r) e escrita(w); o item async permite que o NFS transfira arquivos de forma 'assíncrona', </b><br /><b>&nbsp;&nbsp;&nbsp; sem precisar esperar pela resposta do cliente; e o IP que pode acessar a pasta que foi compartilhada.Depois de </b><br /><b>&nbsp;&nbsp;&nbsp; adicionar a linha, salve o arquivo, lembrando que caso você deseje liberar uma faixa de ips, basta </b><br /><b>&nbsp;&nbsp;&nbsp; usar o *(asterisco), exemplo: 192.168.1.*, todos dessa faixa poderão acessar, ou até mesmo utilizar nome da Estação.</b><br /><b>"</b><br /><b>AUTOR="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>-a, --author</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Verificar o author e o endereço na internet do Script :</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp; Marcos da B. M. Oliveira , terminalroot.com.br</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp; Desde: Dom 08 Dez 2013 20:00:42 BRST </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp; Licença: GPL</b><br /><b>"</b><br /><b># --------------------------------------</b><br /><b><br /></b><b>installNFS(){</b><br /><b><br /></b><b>if [ "$1" ];</b><br /><b>&nbsp;&nbsp;&nbsp; then</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case $1 in</b><br /><b>&nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -h | --help) &nbsp;&nbsp;&nbsp; reset &amp;&amp; echo "$AJUDA $ENTRAR $CONF $AUTOR" ;; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -e | --enter)&nbsp;&nbsp;&nbsp; echo "$ENTRAR" ;; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -c | --conf)&nbsp;&nbsp;&nbsp; echo "$CONF" ;; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -a | --author)&nbsp;&nbsp;&nbsp; echo "$AUTOR" ;;</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Opção inválida." ;;</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; esac</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; shift</b><br /><b>&nbsp;&nbsp;&nbsp; exit 0</b><br /><b>fi</b><br /><b><br /></b><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ -f "/etc/init.d/nfs-kernel-server" ];</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; then</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Já está Instalado.";</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$USER" == "root" ];</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; then</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; reset</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -ne "Deseja instalar o NFS ? (S/n)" &amp;&amp; read RESP</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$RESP" == "S" ]; then</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Iniciando instalação&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1 </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Abortar."; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0;</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; apt-get install -y nfs-kernel-server nfs-common portmap 2&gt;/dev/null</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "Informe o IP ou nome da máquina que poderá acessar essa máquina: "</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; read ip</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "Informe a pasta com o caminho, ex.: /home/$USER/minha_pasta: "</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; read pasta</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Inserindo dados no arquivo /etc/exports: "</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "$pasta $ip(rw,async)" &gt;&gt; /etc/exports</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Exportando para o Kernel com: exportfs -ra&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Exportando para o Kernel com: exportfs -ra&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Restartando o nfs-kernel-server e o portmap&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /etc/init.d/nfs-kernel-server restart</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; etc/init.d/portmap restart</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Pronto!</b><br /><b>Obs.: </b><br /><b>&nbsp;&nbsp;&nbsp; 1) Você pode montar a pasta com: mount -t nfs $ip:$pasta </b><br /><b>&nbsp;&nbsp;&nbsp; 2) Caso não consiga o acesso, lembre-se de dar permissões locais com o 'chmod'.</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; "&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Você precisa ser root.";</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Abortar.";</b><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi</b><br /><b><br /></b><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi</b><br /><b>}</b><br /><b><br /></b><b>installNFS $1 </b></div><b></b>