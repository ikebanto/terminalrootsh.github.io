---
layout: post
title: 'Shell Scripting: Como renomear um diretório com dados de um arquivo'
date: '2013-06-16T13:46:00.000-07:00'
author: The Bang Bash
tags:
- Shell Script
modified_time: '2014-10-29T17:04:27.840-07:00'
thumbnail: http://1.bp.blogspot.com/-FkPcIsY-8fU/Ub4bRVwYWsI/AAAAAAAAB6I/UlsSTr0GR6s/s72-c/shell+script.png
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-3347664661341056373
blogger_orig_url: http://www.terminalroot.com.br/2013/06/shell-scripting-como-renomear-um.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-FkPcIsY-8fU/Ub4bRVwYWsI/AAAAAAAAB6I/UlsSTr0GR6s/s1600/shell+script.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-FkPcIsY-8fU/Ub4bRVwYWsI/AAAAAAAAB6I/UlsSTr0GR6s/s320/shell+script.png" /></a></div><!-------------------------------------------------><br /><br /><script type="text/javascript"><!-- google_ad_client = "ca-pub-5528601613414387"; google_ad_host = "pub-1556223355139109"; /* quadrados */ google_ad_slot = "9713010559"; google_ad_width = 200; google_ad_height = 200; </script><script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript"></script><!-----------------------------------------------><br /><br /><br /><br /><blockquote><b><span style="color: purple;">Olá galera, tive um problema hoje, seguinte: baixei um disco da internet, onde as músicas vieram somente com os números, mas sem o nome das mesmas, pois os nomes vieram num arquivo TXT exemplo:</span></b></blockquote><b><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><span style="color: blue;">Pasta com as músicas:</span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>  </b><br /><div class="separator" style="clear: both; text-align: center;"><b><a href="http://1.bp.blogspot.com/-yIVAP2aYPw4/Ub4dQd_R6DI/AAAAAAAAB6Y/A7YTk9e9eIE/s1600/Captura_de_tela.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="172" src="http://1.bp.blogspot.com/-yIVAP2aYPw4/Ub4dQd_R6DI/AAAAAAAAB6Y/A7YTk9e9eIE/s320/Captura_de_tela.png" width="400" /></a></b></div><b> <br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><u>Então, criei um <span style="color: blue;">Script em Shell</span> que pega a 1° linha do txt e renomea o primeiro arquivo do diretório, depois pega a 2° e renomea a segunda música do diretório...e assim por diante:</u><br /><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><u><span style="color: blue;">Arquivo em TXT</span></u>:<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}<br />01-Alceu Valença-Estação Da luz<br />02-Alceu Valença-Como Dois Animais<br />03-Alceu Valença-Tropicana<br />04-Alceu Valença-Petrolina Juazeiro<br />05-Alceu Valença-Anunciação<br />06-Alceu Valença-Coração Bobo<br />07-Alceu Valença-Solidão<br />08-Alceu Valença-Pelas Ruas Que Andei<br />09-Alceu Valença-Essa Menina<br />10-Alceu Valença-Cabelo No Pente<br />11-Alceu Valença-Leque Moleque<br />12-Alceu Valença-Girassol<br />13-Alceu Valença-O Ovo e a Galinha<br />14-Alceu Valença-Cantiga Do Sapo<br />15-Alceu Valença-Romance Da Bela Inês<br />16-Alceu Valença-Descida da Ladeira<br />17-Alceu Valença-Meu Forró Meu Canto<br />18-Alceu Valença-Rima Com Rima<br />19-Alceu Valença-Vou Pra Campinas<br />20-Alceu Valença-Eu Quero Ver Você Dizer Que Eu Sou Ruim<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /></b><br /><blockquote class="tr_bq"><b><span class="Apple-tab-span" style="white-space: pre;"> </span><span style="color: purple; font-size: large;">Levando em conta que no diretório também existiam outros arquivos que não eram música, ou seja, no formato </span><span style="color: blue; font-size: large;">JPG(Capa do disco)</span><span style="color: purple; font-size: large;"> e o próprio arquivo com as músicas(</span><span style="color: blue; font-size: large;">faixas.txt</span><span style="color: purple; font-size: large;">), então o Script também deve ter a tarefa de </span><span style="color: red; font-size: large;">NÃO</span><span style="color: purple; font-size: large;"> renomeá-los. Com esse algoritmo na cabeça, criei o seguinte:</span></b></blockquote><b><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>✍<span style="color: blue;"> <i>Primeiramente, como as músicas são em MP3, precisava que no arquivo final existisse o .mp3, então inclui uma linha que põe o '.mp3' a palavra no final de cada linha:</i></span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}sed -i 's/$/.mp3/' faixas.txt{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>✍ <i><span style="color: blue;">Conta a quantidade de arquivos no formato MP3 no diretório, onde 'max' seria a variável que me daria a quantidade dos arquivos:</span></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}max=$(ls *.mp3 | wc -l){% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>✍ <i><span style="color: blue;">Cria um diretório temporário:</span></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}mkdir .temp{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>✍<i> <span style="color: blue;">Lista os arquivos em MP3 e a saída joga para um TXT na pasta temporária:</span></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}ls *.mp3 &gt; .temp/lista_antiga_dos_arquivos.txt{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;">   </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>✍ <i><span style="color: blue;">Um loop onde a sequencia(seq) iria do 1 ao 'max':<span class="Apple-tab-span" style="white-space: pre;"> </span></span></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>for i in $(seq 1 $max)<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>do<br /><span class="Apple-tab-span" style="white-space: pre;"> </span> #comandos<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>done<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><span style="color: blue; font-size: large;">Dentro do loop criado acima, coloque tais comandos:</span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>♛ <i><u><span style="color: purple;">Lê a linha da lista criada com o 'ls' e joga um linha do loop para um outro arquivo, ainda na pasta temporária</span></u></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}sed "$i!d" .temp/lista_antiga_dos_arquivos.txt &gt; .temp/uma_das_musicas_lista_VELHA.txt{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>♛ <i><u><span style="color: purple;">Armazena a linha(nome antigo, ex.: 01.mp3) numa variável:</span></u></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}velho=$(cat .temp/uma_das_musicas_lista_VELHA.txt){% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>♛<i> A<span style="color: purple;"><u>gora lê a lista das faixas(COM OS NOMES QUE DESEJA-SE RENOMEAR) e também joga num outro arquivo temporário:</u></span></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}sed "$i!d" faixas.txt &gt; .temp/uma_das_musicas_lista_NOVA.txt{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>♛ <i><u><span style="color: purple;">Armazena a linha(NOME NOVO DA MÚSICA) numa variável:</span></u></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}novo=$(cat .temp/uma_das_musicas_lista_NOVA.txt){% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>♛ <i><span style="color: purple;"><u>Finalmente substitímos o nome dos arquivo(RENOMEAMOS)</u></span></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}mv "$velho" "$novo"{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>♛ <i><span style="color: purple;"><u>Imprime o novo nome só para acompanhar a renomeação:</u></span></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}echo "$novo"{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>✍ <i><u><span style="color: purple;">E por fim, FORA DO LOOP, removemos a pasta temporária:</span></u></i><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>{% highlight bash %}rm -rf .temp{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><span style="color: blue;">Veirifique o código completo do Script:</span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>PasteBin:<br /> <script src="http://pastebin.com/embed_js.php?i=wX5N7KPd"></script> <br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>Codigo:</b><br />{% highlight bash %}<span style="font-family: monospace;">#!/bin/bash</span><br /><span style="font-family: monospace;"># www.terminalroot.com.br</span><br /><span style="font-family: monospace;">sed -i 's/$/.mp3/' faixas.txt</span><br /><span style="font-family: monospace;">max=$(ls *.mp3 | wc -l)</span><br /><span style="font-family: monospace;">mkdir .temp</span><br /><span style="font-family: monospace;">ls *.mp3 &gt; .temp/lista_antiga_dos_arquivos.txt</span><br /><span style="font-family: monospace;"><br /></span><span style="font-family: monospace;">for i in $(seq 1 $max)</span><br /><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>do<span class="Apple-tab-span" style="white-space: pre;"> </span></span><br /><span style="font-family: monospace;"><br /></span><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>sed "$i!d" .temp/lista_antiga_dos_arquivos.txt &gt; .temp/uma_das_musicas_lista_VELHA.txt</span><br /><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>velho=$(cat .temp/uma_das_musicas_lista_VELHA.txt)</span><br /><span style="font-family: monospace;"><br /></span><span style="font-family: monospace;"><br /></span><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>sed "$i!d" faixas.txt &gt; .temp/uma_das_musicas_lista_NOVA.txt</span><br /><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>novo=$(cat .temp/uma_das_musicas_lista_NOVA.txt)</span><br /><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>mv "$velho" "$novo"</span><br /><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>echo $novo</span><br /><span class="Apple-tab-span" style="white-space: pre;"><span style="font-family: monospace;">  </span></span><br /><span style="font-family: monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>done</span><br /><span class="Apple-tab-span" style="white-space: pre;"><span style="font-family: monospace;"> </span></span><br />rm -rf .temp{% endhighlight %}<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><b><span style="color: blue;"><i><u>Por fim a pasta ficou assim</u></i></span></b>:<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>   <br /><div class="separator" style="clear: both; text-align: center;"><b><a href="http://1.bp.blogspot.com/-McEhnKVvK0o/Ub4dQgFAElI/AAAAAAAAB6c/L_zFWNWN0Bk/s1600/Captura_de_tela-1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="182" src="http://1.bp.blogspot.com/-McEhnKVvK0o/Ub4dQgFAElI/AAAAAAAAB6c/L_zFWNWN0Bk/s320/Captura_de_tela-1.png" width="400" /></a></b></div><b><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>Valeu!<br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span></b>