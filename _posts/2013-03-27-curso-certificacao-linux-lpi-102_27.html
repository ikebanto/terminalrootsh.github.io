---
layout: post
title: 'Curso Certificação Linux LPI-102: Serviços de Rede no Linux'
date: '2013-03-27T16:49:00.000-07:00'
description: 'Curso Certificação Linux LPI-102: Serviços de Rede no Linux'
main-class: 'linux'
color: '#3b5998'
author: The Bang Bash
tags:
- Linux
- LPI
modified_time: '2013-05-03T07:16:04.576-07:00'
thumbnail: http://4.bp.blogspot.com/-ENcjFGaI_6w/UVODld7N7KI/AAAAAAAABRE/Y26E7Gr3Bms/s72-c/Servi%C3%A7os+de+Rede+no+Linux.jpg
twitter_text: 'Curso Certificação Linux LPI-102: Serviços de Rede no Linux'
introduction: 'Curso Certificação Linux LPI-102: Serviços de Rede no Linux'
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ENcjFGaI_6w/UVODld7N7KI/AAAAAAAABRE/Y26E7Gr3Bms/s1600/Servi%C3%A7os+de+Rede+no+Linux.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-ENcjFGaI_6w/UVODld7N7KI/AAAAAAAABRE/Y26E7Gr3Bms/s320/Servi%C3%A7os+de+Rede+no+Linux.jpg" /></a></div><!-------------------------------------------------> <script type="text/javascript"><!-- google_ad_client = "ca-pub-5528601613414387"; google_ad_host = "pub-1556223355139109"; /* quadrados */ google_ad_slot = "9713010559"; google_ad_width = 200; google_ad_height = 200; </script><script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript"></script><!-----------------------------------------------><br /><br /><blockquote class="tr_bq"><b>&nbsp;&nbsp;&nbsp; Serviços de rede é o que está disponí­vel para ser acessado pelo usuário. No TCP/IP, cada serviço é associado a um número chamado porta que é onde o servidor espera pelas conexões dos computadores clientes. Uma porta de rede pode ser referenciada tanto pelo número como pelo nome do serviço.</b></blockquote><b><br />Abaixo, alguns exemplos de portas padrões usadas em serviços TCP/IP:<br /></b><br /><blockquote class="tr_bq"><b>&nbsp;&nbsp;&nbsp; 21 - FTP (transferência de arquivos)</b><br /><b>&nbsp;&nbsp;&nbsp; 23 - Telnet (terminal virtual remoto)</b><br /><b>&nbsp;&nbsp;&nbsp; 25 - Smtp (envio de e-mails)</b><br /><b>&nbsp;&nbsp;&nbsp; 53 - DNS (resolvedor de nomes)</b><br /><b>&nbsp;&nbsp;&nbsp; 79 - Finger (detalhes sobre usuários do sistema)</b><br /><b>&nbsp;&nbsp;&nbsp; 80 - http (protocolo www - transferência de páginas Internet)</b><br /><b>&nbsp;&nbsp;&nbsp; 110 - Pop-3 (recebimento de mensagens)</b><br /><b>&nbsp;&nbsp;&nbsp; 119 - NNTP (usado por programas de noticias)</b></blockquote><b><br />O arquivo padrão responsável pelo mapeamento do nome dos serviços e das portas mais utilizadas é o /etc/services (para detalhes sobre o seu formato, veja a [#s-rede-outros-services /etc/services.<br /></b><br /><blockquote class="tr_bq"><b>Para instalá-lo, basta:</b><br /><br /><b>{% highlight bash %}apt-get install openbsd-inetd{% endhighlight %}</b></blockquote><b><br /><span style="font-size: large;">Serviços iniciados como Daemons de rede</span><br /><br />Serviços de rede iniciados como daemons ficam residente o tempo todo na memória esperando que alguém se conecte (também chamado de modo standalone). Um exemplo de daemon é o servidor proxy squid e o servidor web Apache operando no modo daemon.<br /><br />Alguns programas servidores oferecem a opção de serem executados como daemons ou através do inetd. É recomendável escolher daemon se o serviço for solicitado frequentemente (como é o caso dos servidores web ou proxy).<br /><br />Para verificar se um programa está rodando como daemon, basta digitar ps ax e procurar o nome do programa, em caso positivo ele é um daemon.<br /><br />Normalmente os programas que são iniciados como daemons possuem seus próprios recursos de segurança/autenticação para decidir quem tem ou não permissão de se conectar.</b><br /><b><br /><span style="font-size: large;">Serviços iniciados através do inetd</span><br /><br />Serviços iniciados pelo inetd são carregados para a memória somente quando são solicitados. O controle de quais serviços podem ser carregados e seus parâmetros, são feitos através do arquivo&nbsp;</b><br /><br /><b><i><span style="font-size: large;">/etc/inetd.conf.</span></i><br /><br />Um daemon chamado inetd lê as configurações deste arquivo e permanece residente na memória, esperando pela conexão dos clientes. Quando uma conexão é solicitada, o daemon inetd verifica as permissões de acesso nos arquivos /etc/hosts.allow e /etc/hosts.deny e carrega o programa servidor correspondente no arquivo /etc/inetd.conf. Um arquivo também importante neste processo é o /etc/services que faz o mapeamento das portas e nomes dos serviços.<br /><br />Alguns programas servidores oferecem a opção de serem executados como daemons ou através do inetd. É recomendável escolher inetd se o serviço não for solicitado frequentemente (como é o caso de servidores ftp, telnet, talk, etc).<br />/etc/inetd.conf<br /><br />O arquivo /etc/inetd.conf é um arquivo de configuração para o daemon servidor inetd. Sua função é dizer ao inetd o que fazer quando receber uma requisição de conexão para um serviço em particular. Para cada serviço que deseja aceitar conexões, você precisa dizer ao inetd qual daemon servidor executar e como executa-lo.<br /><br />Seu formato é também muito simples. É um arquivo texto com cada linha descrevendo um serviço que deseja oferecer. Qualquer texto em uma linha seguindo uma "#" é ignorada e considerada um comentário. Cada linha contém sete campos separados por qualquer número de espaços em branco (tab ou espaços). O formato geral é o seguinte:<br /><br /></b><br /><blockquote class="tr_bq"><b>&nbsp;&nbsp;&nbsp;&nbsp; </b><span style="font-size: x-small;"><i>serviço&nbsp; tipo_soquete&nbsp; proto&nbsp; opções.num&nbsp; usuário&nbsp; caminho_serv. opções_serv.</i></span></blockquote><b><br /><span style="font-size: large;">serviço</span><br />&nbsp;&nbsp;&nbsp; É o serviço relevante a este arquivo de configuração pego do arquivo /etc/services.<br /><span style="font-size: large;">tipo_soquete</span><br />&nbsp;&nbsp;&nbsp; Este campo descreve o tipo do soquete que este item utilizará, valores permitidos são: stream, dgram, raw, rdm, ou seqpacket. Isto é um pouco técnico de natureza, mas como uma regra geral, todos os serviços baseados em tcp usam stream e todos os protocolos baseados em udp usam dgram. Somente alguns tipos de daemons especiais de servidores usam os outros valores.<br /><span style="font-size: large;">protocolo</span><br />&nbsp;&nbsp;&nbsp; O protocolo é considerado válido para esta item. Isto deve bater com um item apropriado no arquivo /etc/services e tipicamente será tcp ou udp. Servidores baseados no Sun RPC (Remote Procedure Call), utilizam rpc/tcp ou rpc/udp.<br /><span style="font-size: large;">opções</span><br />&nbsp;&nbsp;&nbsp; Existem somente duas configurações para este campo. A configuração deste campo diz ao inetd se o programa servidor de rede libera o soquete após ele ser iniciado e então se inetd pode iniciar outra cópia na próxima requisição de conexão, ou se o inetd deve aguardar e assumir que qualquer servidor já em execução pegará a nova requisição de conexão.<br /><br />Este é um pequeno truque de trabalho, mas como uma regra, todos os servidores tcp devem ter este parâmetro ajustado para nowait e a maior parte dos servidores udp deve tê-lo ajustado para wait. Foi alertado que existem algumas excessões a isto, assim deixo isto como exemplo se não estiver seguro. O número especificado após o "." é opcional e define a quantidade máxima de vezes que o serviço poderá ser executado durante 1 minuto. Se o serviço for executado mais vezes do que este valor, ele será automaticamente desativado pelo inetd e uma mensagem será mostrada no log do sistema avisando sobre o fato. Para reativar o serviço interrompido, reinicie o inetd com: killall -HUP inetd. O valor padrão é 40.<br /><br /><span style="font-size: large;">usuário</span><br />&nbsp;&nbsp;&nbsp; Este campo descreve que conta de usuário usuário no arquivo /etc/passwd será escolhida como dono do daemon de rede quando este for iniciado. Isto é muito útil se você deseja diminuir os riscos de segurança. Você pode ajustar o usuário de qualquer item para o usuário nobody, assim se a segurança do servidor de redes é quebrada, a possibilidade de problemas é minimizada. Normalmente este campo é ajustado para root, porque muitos servidores requerem privilégios de usuário root para funcionarem corretamente.<br /><span style="font-size: large;">caminho_servidor</span><br />&nbsp;&nbsp;&nbsp; Este campo é o caminho para o programa servidor atual que será executado.<br /><span style="font-size: large;">argumentos_servidor</span><br />&nbsp;&nbsp;&nbsp; Este campo inclui o resto da linha e é opcional. Você pode colocar neste campo qualquer argumento da linha de comando que deseje passar para o daemon servidor quando for iniciado.<br /><br />Uma dica que pode aumentar significativamente a segurança de seu sistema é comentar (colocar uma #no inicio da linha) os serviços que não serão utilizados.<br /><br />Abaixo um modelo de arquivo </b><i>/etc/inetd.conf</i><b> usado em sistemas Debian:<br /><br />{% highlight bash %}<br />&nbsp;&nbsp;&nbsp;&nbsp; # /etc/inetd.conf:&nbsp; veja inetd(8) para mais detalhes.<br />&nbsp;&nbsp;&nbsp;&nbsp; #<br />&nbsp;&nbsp;&nbsp;&nbsp; # Banco de Dados de configurações do servidor Internet<br />&nbsp;&nbsp;&nbsp;&nbsp; #<br />&nbsp;&nbsp;&nbsp;&nbsp; #<br />&nbsp;&nbsp;&nbsp;&nbsp; # Linhas iniciando com "#:LABEL:" ou "#&amp;lt;off&amp;gt;#" não devem<br />&nbsp;&nbsp;&nbsp;&nbsp; # ser alteradas a não ser que saiba o que está fazendo!<br />&nbsp;&nbsp;&nbsp;&nbsp; #<br />&nbsp;&nbsp;&nbsp;&nbsp; #<br />&nbsp;&nbsp;&nbsp;&nbsp; # Os pacotes devem modificar este arquivo usando update-inetd(8)<br />&nbsp;&nbsp;&nbsp;&nbsp; #<br />&nbsp;&nbsp;&nbsp;&nbsp; # &amp;lt;nome_serviço&amp;gt; &amp;lt;tipo_soquete&amp;gt; &amp;lt;proto&amp;gt; &amp;lt;opções&amp;gt; &amp;lt;usuário&amp;gt; &amp;lt;caminho_servidor&amp;gt; &amp;lt;args&amp;gt;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #<br />&nbsp;&nbsp;&nbsp;&nbsp; #:INTERNO: Serviços internos<br />&nbsp;&nbsp;&nbsp;&nbsp; #echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dgram&nbsp;&nbsp; udp wait&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #chargen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #chargen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dgram&nbsp;&nbsp; udp wait&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #discard&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #discard&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dgram&nbsp;&nbsp; udp wait&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #daytime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #daytime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dgram&nbsp;&nbsp; udp wait&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp; internal<br />&nbsp;&nbsp;&nbsp;&nbsp; #time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dgram&nbsp;&nbsp; udp wait&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; internal<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:PADRÕES: Estes são serviços padrões.<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:BSD: Shell, login, exec e talk são protocolos BSD.<br />&nbsp;&nbsp;&nbsp;&nbsp; #shell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp; /usr/sbin/tcpd&nbsp; /usr/sbin/in.rshd<br />&nbsp;&nbsp;&nbsp;&nbsp; #login&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp; /usr/sbin/tcpd&nbsp; /usr/sbin/in.rlogind<br />&nbsp;&nbsp;&nbsp;&nbsp; #exec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp nowait&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp; /usr/sbin/tcpd&nbsp; /usr/sbin/in.rexecd<br />&nbsp;&nbsp;&nbsp;&nbsp; talk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dgram&nbsp;&nbsp; udp wait.10&nbsp;&nbsp;&nbsp; nobody.tty&nbsp; /usr/sbin/tcpd&nbsp; /usr/sbin/in.talkd<br />&nbsp;&nbsp;&nbsp;&nbsp; ntalk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dgram&nbsp;&nbsp; udp wait.10&nbsp;&nbsp;&nbsp; nobody.tty&nbsp; /usr/sbin/tcpd&nbsp; /usr/sbin/in.ntalkd<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:MAIL: Mail, news e serviços uucp.<br />&nbsp;&nbsp;&nbsp;&nbsp; smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream&nbsp; tcp&nbsp;&nbsp;&nbsp;&nbsp; nowait.60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail&nbsp;&nbsp;&nbsp; /usr/sbin/exim exim -bs<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:INFO: Serviços informativos<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:BOOT: O serviço Tftp é oferecido primariamente para a inicialização. Alguns sites<br />&nbsp;&nbsp;&nbsp;&nbsp; # o executam somente em máquinas atuando como "servidores de inicialização".<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:RPC: Serviços baseados em RPC<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:HAM-RADIO: serviços de rádio amador<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; #:OTHER: Outros serviços{% endhighlight %}<br /><br />Para saber como configurar o inetd.conf para habilitar uma porta, acesse esse <a href="http://marcospinguim.blogspot.com.br/2011/12/como-configurar-o-inetdconf-para.html" target="_blank">LINK</a>(<a href="http://marcospinguim.blogspot.com.br/2011/12/como-configurar-o-inetdconf-para.html" target="_blank">Como configurar o inetd.conf para habilitar uma porta</a>).<br /><br /><br /><br /><span style="font-size: x-large;">Utilizando TCPWRAPPERS para segurança do inetd</span><br /></b><br /><blockquote><b>&nbsp;&nbsp; &nbsp;O tcpwrapper regula o acesso aos serviços oferecidos pelo inetd.O processo utilizado é o /usr/sbin/tcpd.Ele consulta dois arquivos que definem o acesso:</b></blockquote><b>&nbsp;&nbsp; <br />{% highlight bash %}<br />/etc/hosts.allow<br />/etc/hosts.deny{% endhighlight %}<br /><br />&nbsp;&nbsp; &nbsp;As regras contidas no primeiro arquivo liberam o acesso aos serviços.O segundo arquivo proíbe o acesso.<br />&nbsp;&nbsp; &nbsp;Basicamente as regras destes arquivos seguem o padrão.<br />&nbsp;&nbsp; <br />{% highlight bash %}nome_do_serviço : endereços{% endhighlight %}<br /><br />&nbsp;&nbsp; &nbsp;As palavras LOCAL e ALL podem ser utilizadas para identificar todos os clientes que são do mesmo domínio que o servidor e todas as máquinas.<br />&nbsp;&nbsp; <br />&nbsp;&nbsp; &nbsp;Veja o exemplo de /etc/hosts.allow:<br />&nbsp;&nbsp; <br />{% highlight bash %}<br /># cat /etc/hosts.allow<br />in.telnetd : LOCAL<br />rsyncd : 172.20.0.0/255.255.255.0<br />in.ftpd : ALL{% endhighlight %}<br /><br />&nbsp;&nbsp; &nbsp;Se neste arquivos de controle não existir uma regra para um determinado serviço habilitado no inetd, o acesso será liberado.<br />&nbsp;&nbsp; <br /><span style="font-size: x-large;">Serviços de rede com xinetd</span><br /></b><br /><blockquote><b>Uma rede de computadores serve basicamente, para possibilitar o compartilhamento de recursos, como arquivos e impressoras. É possível dizer que o compartilhamento de arquivos e impressoras é um Serviço de Rede.</b></blockquote><b><br /><i>Outros serviços de rede tornaram-se muito populares com a expansão da Internet nos últimos anos. Tais serviços, como o WWW e FTP, requerem que um computador execute algum processo que atenda pelas requisições dos clientes que desejam acessá-los. Isto implica em um modelo cliente-servidor, onde normalmente a máquina do usuário solicita alguma coisa, através de um programa cliente como o browser, por exemplo, e o processo servidor (que implementa o serviço da rede) responde.</i><br /><br /><u>O sistema operacional UNIX, e, portanto o Linux, sempre foi muito conhecido por oferecer diversos serviços de rede tradicionais. Tais serviços vão desde a possibilidade de saber quem está usando uma máquina, até o próprio serviço de transferência de arquivos.</u><br /></b><br /><blockquote><b>Muitos serviços de rede são implementados através de processos dedicados que esperam por requisições que chegam da rede. Mas dada a razoável quantidade de serviços, um esquema interessante foi implantado. Neste esquema, um único processo, chamado xinetd (Extend Internet Super Server), rodando na máquina que está oferecendo os serviços de rede, é responsável por escutar as requisições que chegam, e conforme a porta por onde chega à requisição, disparar e executar o processo correspondente àquele serviço.</b></blockquote><b><br /><i>Assim, da mesma forma que um endereço IP identifica uma máquina em uma rede, uma porta identifica um serviço de rede rodando dentro de determinada máquina. Alguns serviços funcionam sobre o protocolo de transporte TCP, outros sobre o protocolo UDP, e ainda outros funcionam sobre os dois.</i><br /><br /><u>O xinetd é responsável por vários serviços básicos de um sistema disponibilizados em uma rede. Entre os serviços que ele gerencia estão os serviços Telnet e POP.</u><br /></b><br /><blockquote><b>Esses serviços são executados por programas denominados servidores, que nada mais são do que programas que abrem uma determinada porta e ficam aguardando por solicitações de conexão.</b></blockquote><b><br /><i>Na maioria dos casos, quando uma solicitação é recebida o servidor cria um processo filho para tratar dessa conexão específica, enquanto o processo pai continua a escutar na porta aguardando novas solicitações. Desta forma existirão vários processos alocados na memória.</i><br /><br /><u>O xinetd carrega seu arquivo de configuração e passa a “ouvir” por conexões em portas específicas. Quando uma conexão é solicitada, o xinetd executa o programa servidor correspondente para manipular o serviço solicitado. Então, desta forma, existirá apenas um servidor em memória esperando por uma solicitação.</u><br /><br />O superservidor ou xinetd é configurado para iniciar a sua execução quando o sistema é inicializado, recebendo a lista de serviços a serem monitorados a partir de um arquivo denominado /etc/xinetd.conf.</b>