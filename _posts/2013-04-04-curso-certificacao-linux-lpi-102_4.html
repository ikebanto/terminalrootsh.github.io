---
layout: post
title: 'Curso Certificação Linux LPI-102: Configurando o Shell Seguro OpenSSH'
date: '2013-04-04T16:16:00.000-07:00'
description: 'Curso Certificação Linux LPI-102: Configurando o Shell Seguro OpenSSH'
main-class: 'linux'
color: '#3b5998'
author: The Bang Bash
tags:
- Linux
- LPI
modified_time: '2013-05-03T07:16:04.136-07:00'
thumbnail: http://3.bp.blogspot.com/-Uh4gmw15W1c/UVZCI3kuPBI/AAAAAAAABTU/FkNUqv2jBj0/s72-c/ssh.jpeg
twitter_text: 'Curso Certificação Linux LPI-102: Configurando o Shell Seguro OpenSSH'
introduction: 'Curso Certificação Linux LPI-102: Configurando o Shell Seguro OpenSSH'
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-Uh4gmw15W1c/UVZCI3kuPBI/AAAAAAAABTU/FkNUqv2jBj0/s1600/ssh.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-Uh4gmw15W1c/UVZCI3kuPBI/AAAAAAAABTU/FkNUqv2jBj0/s200/ssh.jpeg" height="140" width="200" /></a></div><!-------------------------------------------------> <script type="text/javascript"><!-- google_ad_client = "ca-pub-5528601613414387"; google_ad_host = "pub-1556223355139109"; /* quadrados */ google_ad_slot = "9713010559"; google_ad_width = 200; google_ad_height = 200; </script><script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript"></script><!-----------------------------------------------></p><p></p><p><b>Em informática o Secure Shell ou SSH é, simultaneamente, um programa de computador e um protocolo de rede que permite a conexão com outro computador na rede, de forma a executar comandos de uma unidade remota. Possui as mesmas funcionalidades do TELNET, com a vantagem da conexão entre o cliente e o servidor ser criptografada.Uma de suas mais utilizadas aplicações é o chamado Tunnelling, que oferece a capacidade de redirecionar pacotes de dados.</b></p><p><b></p><p></b></p><p><span style="font-size: large;"><b>Instalação</b></span></p><p><b></p><p></b></p><p><b>Para instalar o cliente e os server, apesar do cliente já vir instalado por default no Debian e em outras distribuições:{% highlight bash %}# apt-get install openssh-client openssh-server{% endhighlight %}</b></p><p><b></p><p></b></p><p><span style="font-size: large;"><b>Usuários e Conexão</b></span></p><p><b></p><p></b></p><p><b>Para conectar via IP ou por nome, levará em conta o nome do usuario que você está logado no local de conexão, exemplo se você está como "root", ele solicitará a senha de "root" do computador que você deseja, se tiver logado como "marcos" se no computador que você está tentando logar como "marcos" não houver este usuário, você receberá a "Conection Refused", e se tiver, deverá colocar a senha, ou usar o nome do usuario na frente e depois por o "@" e logo após o IP ou o nome do computador, depois é só pôr a senha do usuario ex.:{% highlight bash %}# ssh 192.168.1.107</p><p># ssh algumsite.com</p><p># ssh root@192.168.1.107</p><p># ssh marcos@192.168.1.107{% endhighlight %}, DEBUG - LOG - faça a conexão com -vv para exibir as mensagens, ajuda na localização de problemas, tente também iniciar o iniciar o servidor em modo debug (ssh -d) e conectar com o cliente, provavelmente o servidor vai exibir as mensagens de erros, tais como permissões e etc..., exemplos:</b></p><p><b>{% highlight bash %}# ssh -vv marcos@localhost</p><p># ssh -v marcos@localhost{% endhighlight %}, para restringir acesso, deve editar o arquivo <i># /etc/ssh/sshd_config</i>, no arquivo que se abrirá, procure a linha que contém a palavra "Subsystem", estará assim:{% highlight bash %}Subsystem sftp /usr/lib/openssh/sftp-server{% endhighlight %}, bastar adicionar o "AllowUsers", ficará assim, ex.:</b></p><p><b>{% highlight bash %}Subsystem sftp /usr/lib/openssh/sftp-server</p><p>AllowUsers marcos eric camila{% endhighlight %},Enquanto não utilizada a diretiva "AllowUsers" qualquer usuário da maquina pode conectar via ssh. Quando acrescenta-la, passa a permitir apenas os usuários listados e válidos na maquina, esta diretiva prevalece sobre a regra "default" que permite login de todos.</b></p><p><span style="font-size: large;"><b></p><p></b></span></p><p><span style="font-size: large;"><b>Alterando a Porta</b></span></p><p><b></p><p></b></p><p><b>A porta padrão do ssh é 22, por isto tem muitos scripts que ficam tentando conexão nesta porta, por este e outros motivos, pode se alterar a porta do ssh, por exemplo, alterar de 22 para porta 2222, use seu editor preferido para editar o arquivo /etc/ssh/sshd_config e procure pela linha; #Port 22 altere para Port 2222, depois de efetuar a alteração, precisa reiniciar o serviço, veja no tópico sobre instalação, para testar na própria maquina, em um konsole execute a linha de comando neste formato:{% highlight bash %}# ssh -p 2222 marcos@192.168.1.107</p><p># /etc/init.d/ssh restart{% endhighlight %}</b></p><p><b></p><p></b></p><p><b>Copiar arquivos remotamente com SSH</b></p><p><b></p><p></b></p><p><b>Nesse exemplo abaixo vou copiar o arquivo "teste.txt" para o a máquina remota, isso será copiado para o diretório <i>/home/marcos/</i>, lógico, irá pedir senha antes de executar a cópia:</b></p><p><b>{% highlight bash %}# scp teste.txt marcos@192.168.1.102:~/</p><p>marcos@192.168.1.102's password:{% endhighlight %}</b> </p><p><b>ou </b></p><p><b>{% highlight bash %}# scp teste.txt marcos@192.168.1.102:/home/marcos/</p><p>marcos@192.168.1.102's password:{% endhighlight %}, para copiar todos os arquivos e sub-diretórios a partir do Shell local para o home do usuário marcos no destino.</b></p><p><b>{% highlight bash %}scp -r * marcos@192.168.1.107:~/{% endhighlight %}, para copiar para um sub-diretorio especifico no micro de destino, não use (~) e informe o caminho:</b></p><p><b>{% highlight bash %}scp -r * marcos@192.168.1.107:/home/marcos/pasta_server/{% endhighlight %}, para copiar da máquina remota para máquina local, usa-se o ponto no final e o formato assim:</b></p><p><b>{% highlight bash %}scp marcos@192.168.1.107:/home/eric/arquivo_remoto.txt . {% endhighlight %}, o ponto no final da linha indica para salvar no diretório atual.Salvar em outro local, substitua o ponto "." pelo caminho na maquina local, exemplo para salvar na maquina local em <i>/home/marcos/tmp</i>:</b></p><p><b>{% highlight bash %}scp marcos@192.168.1.107:~/teste.txt /home/marcos/tmp</p><p>scp -r marcos@192.168.1.107:~/isos /home/marcos/tmp{% endhighlight %}</b></p><p><b></p><p></b></p><p><b>Tem diversas outras coisa que você pode fazer com o SSH, caso deseje mais informações, consulte:</b></p><p><b><a href="http://zago.eti.br/ssh/ssh.html">http://zago.eti.br/ssh/ssh.html</a> , e lá possui mais fontes.</b></p><p><b></p><p></b></p><p><b>Espero que gostem e comentem!</b></p><p><b></p><p></b>

</p>
