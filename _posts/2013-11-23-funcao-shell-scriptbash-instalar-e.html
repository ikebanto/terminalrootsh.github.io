---
layout: post
title: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
date: '2013-11-23T15:21:00.000-08:00'
description: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
main-class: 'bash'
color: '#c2003a'
author: The Bang Bash
tags:
- Shell Script
- Servidores
modified_time: '2014-10-28T15:50:36.844-07:00'
thumbnail: http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s72-c/shell+script2.png
twitter_text: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
introduction: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s1600/shell+script2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s320/shell+script2.png" /></a></div></p><p><blockquote class="tr_bq"><i><span style="color: purple;"><b>Você (pode e deve) customizá-lo para sua instalação, por exemplo:</b></span></i></p><p><i><span style="color: purple;"><b></p><p></b></span></i><i><span style="color: purple;"><b>o user root foi só um exemplo;</b></span></i></p><p><i><span style="color: purple;"><b>a porta foi só um exemplo;</b></span></i></p><p><i><span style="color: purple;"><b>o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;</b></span></i></p><p><i><span style="color: purple;"><b>altere, caso queira ao seu gosto.</b></span></i></blockquote></p><p><b><span style="color: blue;"><u><i><span style="font-size: large;">Mais Informações</span></i></u></span>: <a href="http://www.terminalroot.com.br/2011/12/utilizando-o-ssh.html" target="_blank">http://www.terminalroot.com.br/2011/12/utilizando-o-ssh.html</a></b></p><p><span style="color: purple;"><u><i><span style="font-size: large;"><b>PasteBin</b></span></i></u></span>:</p><p><script src="http://pastebin.com/embed_js.php?i=NUmjYC9t"></script> </p><p><span style="font-size: large;"><u><i><b>CodeBlog</b></i></u></span>:</p><p><div class="adp">#!/bin/bash</p><p># --------------------------------------</p><p># ./installOpenSSH</p><p>#</p><p># Função Shell Script(Bash): Instalar e Configurar o OpenSSH</p><p>#</p><p># Você (pode e deve) customizá-lo para sua instalação, por exemplo:</p><p># o user root foi só um exemplo;</p><p># a porta foi só um exemplo;</p><p># o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;</p><p># altere, caso queira ao seu gosto.</p><p>#</p><p># Uso: ./installOpenSSH</p><p>AJUDA="Exemplo:</p><p>SINOPSE</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ./installOpenSSH [OPÇÕES]</p><p></p><p>DESCRIÇÃO</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Função Shell Script(Bash): Instalar e Configurar o OpenSSH</p><p></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -h, --help</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para verificar como usar ."</p><p>ENTRAR="</p><p>-e, --enter</p><p>&nbsp;&nbsp;&nbsp; &nbsp; Para conectar a máquina remota(Obs.: Se sua máquina usar o 'sudo', coloque o sudo antes):</p><p>&nbsp;&nbsp;&nbsp; &nbsp; ssh -p 2222 [IP da máquina remota]</p><p>&nbsp;&nbsp;&nbsp; &nbsp; ou</p><p>&nbsp;&nbsp;&nbsp; &nbsp; sudo ssh -p 2222 [IP da máquina remota]</p><p>&nbsp;&nbsp;&nbsp; &nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp; Ex.:</p><p>&nbsp;&nbsp;&nbsp; &nbsp; ssh -p 2222 192.168.1.2</p><p>&nbsp;&nbsp;&nbsp; &nbsp; ou</p><p>&nbsp;&nbsp;&nbsp; &nbsp; sudo ssh -p 2222 192.168.1.2"</p><p>COPIAR="</p><p>-c, --copy</p><p>&nbsp;&nbsp;&nbsp; Para copiar da máquina remota para seu PC (Obs.: Se sua máquina usar o 'sudo', coloque o sudo antes), (-r para diretórios, recursivamente):</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; scp -P 2222 -r [IP da máquina REMOTA]:/[PASTA e/ou ARQUIVO da máquina REMOTA] /[PASTA do seu PC]</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ou</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sudo scp -P 2222 -r [IP da máquina REMOTA]:/[PASTA e/ou ARQUIVO da máquina REMOTA] /[PASTA do seu PC]</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Ex.:</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; scp -P 2222 192.168.1.2:/home/user/arquivo.pdf /home/marcos/Downloads/</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ou</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sudo scp -P 2222 192.168.1.2:/home/user/arquivo.pdf /home/marcos/Downloads/</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; Para copiar do seu PC para a máquina remota, ex.:</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; scp -P 2222 /home/user/ 192.168.1.2:/home/marcos/arquivo.pdf"</p><p>AUTOR="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>-a, --author</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Verificar o author e o endereço na internet do Script :</p><p>&nbsp;&nbsp;&nbsp; &nbsp; Marcos da B. M. Oliveira , http://www.terminalroot.com.br/</p><p>&nbsp;&nbsp;&nbsp; &nbsp; Desde: Sáb 23 Nov 2013 19:54:46 BRST </p><p>&nbsp;&nbsp;&nbsp; &nbsp; Licença: GPL</p><p>"</p><p># --------------------------------------</p><p></p><p>installOpenSSH(){</p><p></p><p>if [ "$1" ];</p><p>&nbsp;&nbsp;&nbsp; then</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case $1 in</p><p>&nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -h | --help) &nbsp;&nbsp;&nbsp; reset &amp;&amp; echo "$AJUDA $ENTRAR $COPIAR $AUTOR" ;; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -e | --enter)&nbsp;&nbsp;&nbsp; echo "$ENTRAR" ;; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -c | --copy)&nbsp;&nbsp;&nbsp; echo "$COPIAR" ;; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -a | --author)&nbsp;&nbsp;&nbsp; echo "$AUTOR" ;;</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Opção inválida." ;;</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; esac</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; shift</p><p>&nbsp;&nbsp;&nbsp; exit 0</p><p>fi</p><p></p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ $(which sshd) ];</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; then</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Já está Instalado.";</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$USER" == "root" ];</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; then</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; reset</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -ne "Deseja instalar o OpenSSH ? (S/n)" &amp;&amp; read RESP</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$RESP" == "S" ]; then</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Iniciando instalação&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1 </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Abortar."; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0;</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; apt-get install -y openssh-client openssh-server 2&gt;/dev/null</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Alterando a Porta&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed -i 's/Port 22/Port 2222/' /etc/ssh/sshd_config</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Adicionando o usuário ROOT:&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed -i "s/Subsystem sftp \/usr\/lib\/openssh\/sftp\-server/Subsystem sftp \/usr\/lib\/openssh\/sftp\-server\\nAllowUsers root/" /etc/ssh/sshd_config</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Restartando o SSHD&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /etc/init.d/ssh restart 2&gt;/dev/null</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Pronto!"&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Você precisa ser root.";</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Abortar.";</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi</p><p></p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi</p><p>}</p><p></p><p>installOpenSSH $1</div></p><p>

</p>
