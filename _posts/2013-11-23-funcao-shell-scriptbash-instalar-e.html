---
layout: post
title: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
date: '2013-11-23T15:21:00.000-08:00'
description: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
main-class: 'bash'
color: '#c2003a'
author: The Bang Bash
tags:
- Shell Script
- Servidores
modified_time: '2014-10-28T15:50:36.844-07:00'
thumbnail: http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s72-c/shell+script2.png
twitter_text: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
introduction: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s1600/shell+script2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s320/shell+script2.png" /></a></div><br /><blockquote class="tr_bq"><i><span style="color: purple;"><b>Você (pode e deve) customizá-lo para sua instalação, por exemplo:</b></span></i><br /><i><span style="color: purple;"><b><br /></b></span></i><i><span style="color: purple;"><b>o user root foi só um exemplo;</b></span></i><br /><i><span style="color: purple;"><b>a porta foi só um exemplo;</b></span></i><br /><i><span style="color: purple;"><b>o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;</b></span></i><br /><i><span style="color: purple;"><b>altere, caso queira ao seu gosto.</b></span></i></blockquote><br /><b><span style="color: blue;"><u><i><span style="font-size: large;">Mais Informações</span></i></u></span>: <a href="http://www.terminalroot.com.br/2011/12/utilizando-o-ssh.html" target="_blank">http://www.terminalroot.com.br/2011/12/utilizando-o-ssh.html</a></b><br /><span style="color: purple;"><u><i><span style="font-size: large;"><b>PasteBin</b></span></i></u></span>:<br /><script src="http://pastebin.com/embed_js.php?i=NUmjYC9t"></script> <br /><span style="font-size: large;"><u><i><b>CodeBlog</b></i></u></span>:<br /><div class="adp">#!/bin/bash<br /># --------------------------------------<br /># ./installOpenSSH<br />#<br /># Função Shell Script(Bash): Instalar e Configurar o OpenSSH<br />#<br /># Você (pode e deve) customizá-lo para sua instalação, por exemplo:<br /># o user root foi só um exemplo;<br /># a porta foi só um exemplo;<br /># o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;<br /># altere, caso queira ao seu gosto.<br />#<br /># Uso: ./installOpenSSH<br />AJUDA="Exemplo:<br />SINOPSE<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ./installOpenSSH [OPÇÕES]<br /><br />DESCRIÇÃO<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Função Shell Script(Bash): Instalar e Configurar o OpenSSH<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -h, --help<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para verificar como usar ."<br />ENTRAR="<br />-e, --enter<br />&nbsp;&nbsp;&nbsp; &nbsp; Para conectar a máquina remota(Obs.: Se sua máquina usar o 'sudo', coloque o sudo antes):<br />&nbsp;&nbsp;&nbsp; &nbsp; ssh -p 2222 [IP da máquina remota]<br />&nbsp;&nbsp;&nbsp; &nbsp; ou<br />&nbsp;&nbsp;&nbsp; &nbsp; sudo ssh -p 2222 [IP da máquina remota]<br />&nbsp;&nbsp;&nbsp; &nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp; Ex.:<br />&nbsp;&nbsp;&nbsp; &nbsp; ssh -p 2222 192.168.1.2<br />&nbsp;&nbsp;&nbsp; &nbsp; ou<br />&nbsp;&nbsp;&nbsp; &nbsp; sudo ssh -p 2222 192.168.1.2"<br />COPIAR="<br />-c, --copy<br />&nbsp;&nbsp;&nbsp; Para copiar da máquina remota para seu PC (Obs.: Se sua máquina usar o 'sudo', coloque o sudo antes), (-r para diretórios, recursivamente):<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; scp -P 2222 -r [IP da máquina REMOTA]:/[PASTA e/ou ARQUIVO da máquina REMOTA] /[PASTA do seu PC]<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ou<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sudo scp -P 2222 -r [IP da máquina REMOTA]:/[PASTA e/ou ARQUIVO da máquina REMOTA] /[PASTA do seu PC]<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Ex.:<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; scp -P 2222 192.168.1.2:/home/user/arquivo.pdf /home/marcos/Downloads/<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ou<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sudo scp -P 2222 192.168.1.2:/home/user/arquivo.pdf /home/marcos/Downloads/<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Para copiar do seu PC para a máquina remota, ex.:<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; scp -P 2222 /home/user/ 192.168.1.2:/home/marcos/arquivo.pdf"<br />AUTOR="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />-a, --author<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Verificar o author e o endereço na internet do Script :<br />&nbsp;&nbsp;&nbsp; &nbsp; Marcos da B. M. Oliveira , http://www.terminalroot.com.br/<br />&nbsp;&nbsp;&nbsp; &nbsp; Desde: Sáb 23 Nov 2013 19:54:46 BRST <br />&nbsp;&nbsp;&nbsp; &nbsp; Licença: GPL<br />"<br /># --------------------------------------<br /><br />installOpenSSH(){<br /><br />if [ "$1" ];<br />&nbsp;&nbsp;&nbsp; then<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; case $1 in<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -h | --help) &nbsp;&nbsp;&nbsp; reset &amp;&amp; echo "$AJUDA $ENTRAR $COPIAR $AUTOR" ;; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -e | --enter)&nbsp;&nbsp;&nbsp; echo "$ENTRAR" ;; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -c | --copy)&nbsp;&nbsp;&nbsp; echo "$COPIAR" ;; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; -a | --author)&nbsp;&nbsp;&nbsp; echo "$AUTOR" ;;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Opção inválida." ;;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; esac<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; shift<br />&nbsp;&nbsp;&nbsp; exit 0<br />fi<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ $(which sshd) ];<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; then<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Já está Instalado.";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$USER" == "root" ];<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; then<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; reset<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -ne "Deseja instalar o OpenSSH ? (S/n)" &amp;&amp; read RESP<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if [ "$RESP" == "S" ]; then<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Iniciando instalação&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1 <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Abortar."; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exit 0;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; apt-get install -y openssh-client openssh-server 2&gt;/dev/null<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Alterando a Porta&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed -i 's/Port 22/Port 2222/' /etc/ssh/sshd_config<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Adicionando o usuário ROOT:&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sed -i "s/Subsystem sftp \/usr\/lib\/openssh\/sftp\-server/Subsystem sftp \/usr\/lib\/openssh\/sftp\-server\\nAllowUsers root/" /etc/ssh/sshd_config<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Restartando o SSHD&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [OK]"<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sleep 1<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /etc/init.d/ssh restart 2&gt;/dev/null<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo -e "* Pronto!"&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Você precisa ser root.";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo "Abortar.";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fi<br />}<br /><br />installOpenSSH $1</div><br />