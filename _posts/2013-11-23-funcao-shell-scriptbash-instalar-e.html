---
layout: post
title: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
date: '2013-11-23T15:21:00.000-08:00'
description: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
main-class: 'bash'
color: '#c2003a'
author: The Bang Bash
tags:
- Shell Script
- Servidores
modified_time: '2014-10-28T15:50:36.844-07:00'
thumbnail: http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s72-c/shell+script2.png
twitter_text: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
introduction: 'Função Shell Script(Bash): Instalar e Configurar o OpenSSH'
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s1600/shell+script2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-_gUy0yQTqZM/UkjQtOlbfaI/AAAAAAAACbc/bn9SFHwydy8/s320/shell+script2.png" /></a></div>
<blockquote class="tr_bq"><i><span style="color: purple;"><b>Você (pode e deve) customizá-lo para sua instalação, por exemplo:</b></span></i>
<i><span style="color: purple;"><b>
</b></span></i><i><span style="color: purple;"><b>o user root foi só um exemplo;</b></span></i>
<i><span style="color: purple;"><b>a porta foi só um exemplo;</b></span></i>
<i><span style="color: purple;"><b>o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;</b></span></i>
<i><span style="color: purple;"><b>altere, caso queira ao seu gosto.</b></span></i></blockquote>
<p><span style="color: blue;"><u><i><span style="font-size: large;">Mais Informações</span></i></u></span>: <a href="http://www.terminalroot.com.br/2011/12/utilizando-o-ssh.html" target="_blank">http://www.terminalroot.com.br/2011/12/utilizando-o-ssh.html</a></p>
<span style="color: purple;"><u><i><span style="font-size: large;"><b>PasteBin</b></span></i></u></span>:
<iframe src="http://pastebin.com/raw/NUmjYC9t" style="border:none;width:100%;"></iframe> 
<span style="font-size: large;"><u><i><b>CodeBlog</b></i></u></span>:
<div class="adp">#!/bin/bash
# --------------------------------------
# ./installOpenSSH
#
# Função Shell Script(Bash): Instalar e Configurar o OpenSSH
#
# Você (pode e deve) customizá-lo para sua instalação, por exemplo:
# o user root foi só um exemplo;
# a porta foi só um exemplo;
# o uso do apt-get é para distros Debian e Debian Like, mas você pode trocar;
# altere, caso queira ao seu gosto.
#
# Uso: ./installOpenSSH
AJUDA="Exemplo:
SINOPSE
 ./installOpenSSH [OPÇÕES]

DESCRIÇÃO
 Função Shell Script(Bash): Instalar e Configurar o OpenSSH

 -h, --help
 Para verificar como usar ."
ENTRAR="
-e, --enter
  Para conectar a máquina remota(Obs.: Se sua máquina usar o 'sudo', coloque o sudo antes):
  ssh -p 2222 [IP da máquina remota]
  ou
  sudo ssh -p 2222 [IP da máquina remota]
  
  Ex.:
  ssh -p 2222 192.168.1.2
  ou
  sudo ssh -p 2222 192.168.1.2"
COPIAR="
-c, --copy
 Para copiar da máquina remota para seu PC (Obs.: Se sua máquina usar o 'sudo', coloque o sudo antes), (-r para diretórios, recursivamente):
  scp -P 2222 -r [IP da máquina REMOTA]:/[PASTA e/ou ARQUIVO da máquina REMOTA] /[PASTA do seu PC]
  ou
  sudo scp -P 2222 -r [IP da máquina REMOTA]:/[PASTA e/ou ARQUIVO da máquina REMOTA] /[PASTA do seu PC]
  
  Ex.:
  scp -P 2222 192.168.1.2:/home/user/arquivo.pdf /home/marcos/Downloads/
  ou
  sudo scp -P 2222 192.168.1.2:/home/user/arquivo.pdf /home/marcos/Downloads/
  
  
 Para copiar do seu PC para a máquina remota, ex.:
  scp -P 2222 /home/user/ 192.168.1.2:/home/marcos/arquivo.pdf"
AUTOR="   
-a, --author
 Verificar o author e o endereço na internet do Script :
  Marcos da B. M. Oliveira , http://www.terminalroot.com.br/
  Desde: Sáb 23 Nov 2013 19:54:46 BRST 
  Licença: GPL
"
# --------------------------------------

installOpenSSH(){

if [ "$1" ];
 then
  
  case $1 in
 
   -h | --help)  reset &amp;&amp; echo "$AJUDA $ENTRAR $COPIAR $AUTOR" ;; 
   -e | --enter) echo "$ENTRAR" ;; 
   -c | --copy) echo "$COPIAR" ;; 
   -a | --author) echo "$AUTOR" ;;
   *)    echo "Opção inválida." ;;
  
  esac
  shift
 exit 0
fi

  if [ $(which sshd) ];
   then
     echo "Já está Instalado.";
     exit 0
  else
    if [ "$USER" == "root" ];
    then
   
     reset
     echo -ne "Deseja instalar o OpenSSH ? (S/n)" &amp;&amp; read RESP
   
     if [ "$RESP" == "S" ]; then
     
      echo -e "* Iniciando instalação    [OK]"
      sleep 1 
     else 
      echo "Abortar."; 
      exit 0;
     fi
   
     apt-get install -y openssh-client openssh-server 2>/dev/null
   
     echo -e "* Alterando a Porta    [OK]"
     sleep 1
     sed -i 's/Port 22/Port 2222/' /etc/ssh/sshd_config
   
     echo -e "* Adicionando o usuário ROOT:   [OK]"
     sleep 1
     sed -i "s/Subsystem sftp \/usr\/lib\/openssh\/sftp\-server/Subsystem sftp \/usr\/lib\/openssh\/sftp\-server\\nAllowUsers root/" /etc/ssh/sshd_config
   
     echo -e "* Restartando o SSHD    [OK]"
     sleep 1
     /etc/init.d/ssh restart 2>/dev/null
   
     echo -e "* Pronto!"   
   else
     echo "Você precisa ser root.";
     echo "Abortar.";
   fi

  fi
}

installOpenSSH $1</div>


</p>
