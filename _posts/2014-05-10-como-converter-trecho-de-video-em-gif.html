---
layout: post
title: Como converter trecho de vídeo em gif (Função Shell Scripting)
date: '2014-05-10T18:28:00.000-07:00'
description: Como converter trecho de vídeo em gif (Função Shell Scripting)
main-class: 'bash'
color: '#c2003a'
author: Marcos Oliveira
tags:
- Shell Script
- Dicas
- Open Source
- Código Aberto
- GNU
- Terminal
- terminalroot
- Comandos
modified_time: '2015-05-26T13:42:50.470-07:00'
thumbnail: http://3.bp.blogspot.com/-AZ2u1zb3QI0/VWPMxE_3PiI/AAAAAAAABQg/l9FuNN_Df6s/s72-c/10988763123_4e89a18085_o.gif
twitter_text: Como converter trecho de vídeo em gif (Função Shell Scripting)
introduction: Como converter trecho de vídeo em gif (Função Shell Scripting)
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-AZ2u1zb3QI0/VWPMxE_3PiI/AAAAAAAABQg/l9FuNN_Df6s/s1600/10988763123_4e89a18085_o.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-AZ2u1zb3QI0/VWPMxE_3PiI/AAAAAAAABQg/l9FuNN_Df6s/s320/10988763123_4e89a18085_o.gif" /></a></div><b>Acabei de criar esse script para quem quiser criar gif de trecho de  vídeo. Há o script dessa função bash, no final desse artigo, como toda  as linhas comentadas, linhas que começam com ‘tralha'(#), no entanto,  vou explicar passo a passo:</b></p><p><b></b><b>1 – Você precisa ter o <a href="https://www.ffmpeg.org/" target="_blank">ffmpeg</a> e o <a href="http://www.imagemagick.org/script/index.php" target="_blank">Image Magik</a> instalados, você pode adquirilos clicando nos links, fazendo o download  e compilando os pacotes, ou pode instalar via instaladores da sua  distribuição: (apt-get; yum; pacman;…) . Não vou explicar essa parte,  pois a maioria já deve saber, e tabém não é o foco do artigo, qualquer  dúvida pesquise o <a href="https://duckduckgo.com/" target="_blank">Duck Duck Go</a>. <img alt=":)" class="wp-smiley" src="http://www.terminalroot.com.br/wp-includes/images/smilies/simple-smile.png" style="height: 1em; max-height: 1em;" /></b></p><p><b></b><b>2 – Usamos o ffmpeg para a 1° etapa da conversão:</b><b>{% highlight bash %}$ ffmpeg -t 5 -ss 00:00:10 -i funny.mp4 out%04d.gif {% endhighlight %}</b></p><p><b></b><b>3 – Depois passamos para segunda etapa da conversão, como o convert:</b><b>{% highlight bash %}$ convert -delay 1x20 -loop 0 out*.gif animation.gif{% endhighlight %}</b></p><p><b></b><b>4 –  Em seguida, finalizamos a conversão com uma otimização:</b><b>{% highlight bash %}convert -layers Optimize animation.gif animation_small.gif{% endhighlight %}</b></p><p><b></b><b>Segue a Função/Script abaixo (possui cabeçalho):</b></p><p><script src="http://pastebin.com/embed_js.php?i=hC8kqsLw"></script><b></b></p><p><div class="adp"><pre><b>#!/bin/bash</p><p># ---------------------------------------------------------------</p><p># gifconv</p><p>#</p><p># Converter trecho de vídeo em gif (Função Shell Scripting)</p><p>#</p><p># Uso: $ sh gifconv.sh </p><p>#    $ ./gifconv </p><p>#   ou , em aso de estar nas funções terminalroot ou</p><p>#   como alias no seu .bashrc</p><p>#    $ gifconv </p><p>#</p><p># Ex.: $ gifconv [Clipe do Bebê.mp4]</p><p>#</p><p># Autor: Marcos da B. M. Oliveira, www.terminalroot.com.br</p><p># Desde: Dom Mai 10 14:41:27 2015 </p><p># Versão: 0.1</p><p># Licença: GPL</p><p># ----------------------------------------------------------------</p><p>_pkgs(){</p><p></p><p> # Verifica se tem o ffmpeg instalado.</p><p> if test -f /usr/bin/ffmpeg ; then</p><p>  echo -n</p><p> else</p><p>  echo "É necessário possuir o 'ffmpeg' para que esse script funcione.";</p><p>  echo "Abortar."</p><p>  exit 0;</p><p> fi</p><p> </p><p> #verifica se tem o convert instalado.</p><p> if test -f /usr/bin/convert ; then</p><p>  echo -n</p><p> else</p><p>  echo "É necessário possuir o 'convert' para que esse script funcione.";</p><p>  echo "Abortar."</p><p>  exit 0;</p><p> fi</p><p>}</p><p></p><p># Funão que irá fazer a onversão</p><p>_gifconv(){</p><p></p><p> # Validador dos pacotes necessários</p><p> _pkgs</p><p></p><p> # Verifica se vc informou o vídeo (se passou o parâmetro)</p><p> if [ -z $1 ]; then</p><p>  echo "Informe o vídeo, ex.: converter.sh video.mp4";</p><p> else</p><p>  # Interação para informar o tempo que será iniciado</p><p>  echo "Informe o tempo de INÍCIO que deseja, iniciar o corte, ex.: 00:05:12";</p><p>  read tempo;</p><p>  </p><p>  # Interação para informar a duração do gif</p><p>  echo "Informe o tempo de DURAÇÃO que deseja, 2 segundos, ex.: 2";</p><p>  read duracao;</p><p>  </p><p>  # Cria um diretório temporário que depoi será excluido</p><p>  mkdir tempdir</p><p>  </p><p>  # Informa que está tudo certo</p><p>  echo "[+] - Transformando o vídeo...aguarde";</p><p>  </p><p>  # Faz a conversão</p><p>  ffmpeg -sameq -ss $tempo -t $duracao -i "$*" tempdir/out%04d.gif 2&gt;/dev/null</p><p> </p><p>  # Nova etapa da conversão</p><p>  convert -delay 1x25 -loop 0 tempdir/out*.gif tempdir/animacao.gif;</p><p>  </p><p>  # Extrai o nome do vídeo que será o mesmo nome pro gif</p><p>  arquivo=$(echo "$*" | rev | cut -c5- | rev);</p><p> </p><p>  # Otimização da conversão</p><p>  convert -layers Optimize tempdir/animacao.gif "$arquivo.gif";</p><p>  </p><p>  # Se tudo der certo, informará o sucesso da operação</p><p>  if [ -f "$arquivo.gif" ]; then</p><p>   echo "Pronto!";</p><p>  else</p><p>   echo "Erro ao transformar arquivo em gif, contacte o dsenvolvedor.";</p><p>  fi</p><p>  </p><p>  # Deleta o diretório temporário</p><p>  [ -d tempdir ] &amp;&amp; rm -rf tempdir;</p><p> </p><p> # Finaliza a verificação </p><p> fi</p><p> </p><p> # Saída</p><p> exit 0</p><p>}</p><p></p><p># Chama a função com o parâmetro*</p><p>_gifconv "$*"</p><p></b></pre></div><b></b><b>E só!</b></p><p><b></b><b><a href="http://pastebin.com/hC8kqsLw" target="_blank">Vê código no PasteBin</a></b></p><p><b></b><b>Esta função/script em Shell/Bash , foi baseada no post:</p><p>http://xmodulo.com/convert-video-animated-gif-image-linux.html</b>

</p>
