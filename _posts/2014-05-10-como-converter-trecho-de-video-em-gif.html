---
layout: post
title: Como converter trecho de vídeo em gif (Função Shell Scripting)
date: '2014-05-10T18:28:00.000-07:00'
description: Como converter trecho de vídeo em gif (Função Shell Scripting)
main-class: 'bash'
color: '#c2003a'
author: Marcos Oliveira
tags:
- Shell Script
- Dicas
- Open Source
- Código Aberto
- GNU
- Terminal
- terminalroot
- Comandos
modified_time: '2015-05-26T13:42:50.470-07:00'
thumbnail: http://3.bp.blogspot.com/-AZ2u1zb3QI0/VWPMxE_3PiI/AAAAAAAABQg/l9FuNN_Df6s/s72-c/10988763123_4e89a18085_o.gif
twitter_text: Como converter trecho de vídeo em gif (Função Shell Scripting)
introduction: Como converter trecho de vídeo em gif (Função Shell Scripting)
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-AZ2u1zb3QI0/VWPMxE_3PiI/AAAAAAAABQg/l9FuNN_Df6s/s1600/10988763123_4e89a18085_o.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-AZ2u1zb3QI0/VWPMxE_3PiI/AAAAAAAABQg/l9FuNN_Df6s/s320/10988763123_4e89a18085_o.gif" /></a></div><b>Acabei de criar esse script para quem quiser criar gif de trecho de  vídeo. Há o script dessa função bash, no final desse artigo, como toda  as linhas comentadas, linhas que começam com ‘tralha'(#), no entanto,  vou explicar passo a passo:</b><br /><b></b><b>1 – Você precisa ter o <a href="https://www.ffmpeg.org/" target="_blank">ffmpeg</a> e o <a href="http://www.imagemagick.org/script/index.php" target="_blank">Image Magik</a> instalados, você pode adquirilos clicando nos links, fazendo o download  e compilando os pacotes, ou pode instalar via instaladores da sua  distribuição: (apt-get; yum; pacman;…) . Não vou explicar essa parte,  pois a maioria já deve saber, e tabém não é o foco do artigo, qualquer  dúvida pesquise o <a href="https://duckduckgo.com/" target="_blank">Duck Duck Go</a>. <img alt=":)" class="wp-smiley" src="http://www.terminalroot.com.br/wp-includes/images/smilies/simple-smile.png" style="height: 1em; max-height: 1em;" /></b><br /><b></b><b>2 – Usamos o ffmpeg para a 1° etapa da conversão:</b><b>{% highlight bash %}$ ffmpeg -t 5 -ss 00:00:10 -i funny.mp4 out%04d.gif {% endhighlight %}</b><br /><b></b><b>3 – Depois passamos para segunda etapa da conversão, como o convert:</b><b>{% highlight bash %}$ convert -delay 1x20 -loop 0 out*.gif animation.gif{% endhighlight %}</b><br /><b></b><b>4 –  Em seguida, finalizamos a conversão com uma otimização:</b><b>{% highlight bash %}convert -layers Optimize animation.gif animation_small.gif{% endhighlight %}</b><br /><b></b><b>Segue a Função/Script abaixo (possui cabeçalho):</b><br /><script src="http://pastebin.com/embed_js.php?i=hC8kqsLw"></script><b></b><br /><div class="adp"><pre><b>#!/bin/bash<br /># ---------------------------------------------------------------<br /># gifconv<br />#<br /># Converter trecho de vídeo em gif (Função Shell Scripting)<br />#<br /># Uso: $ sh gifconv.sh <br />#    $ ./gifconv <br />#   ou , em aso de estar nas funções terminalroot ou<br />#   como alias no seu .bashrc<br />#    $ gifconv <br />#<br /># Ex.: $ gifconv [Clipe do Bebê.mp4]<br />#<br /># Autor: Marcos da B. M. Oliveira, www.terminalroot.com.br<br /># Desde: Dom Mai 10 14:41:27 2015 <br /># Versão: 0.1<br /># Licença: GPL<br /># ----------------------------------------------------------------<br />_pkgs(){<br /><br /> # Verifica se tem o ffmpeg instalado.<br /> if test -f /usr/bin/ffmpeg ; then<br />  echo -n<br /> else<br />  echo "É necessário possuir o 'ffmpeg' para que esse script funcione.";<br />  echo "Abortar."<br />  exit 0;<br /> fi<br /> <br /> #verifica se tem o convert instalado.<br /> if test -f /usr/bin/convert ; then<br />  echo -n<br /> else<br />  echo "É necessário possuir o 'convert' para que esse script funcione.";<br />  echo "Abortar."<br />  exit 0;<br /> fi<br />}<br /><br /># Funão que irá fazer a onversão<br />_gifconv(){<br /><br /> # Validador dos pacotes necessários<br /> _pkgs<br /><br /> # Verifica se vc informou o vídeo (se passou o parâmetro)<br /> if [ -z $1 ]; then<br />  echo "Informe o vídeo, ex.: converter.sh video.mp4";<br /> else<br />  # Interação para informar o tempo que será iniciado<br />  echo "Informe o tempo de INÍCIO que deseja, iniciar o corte, ex.: 00:05:12";<br />  read tempo;<br />  <br />  # Interação para informar a duração do gif<br />  echo "Informe o tempo de DURAÇÃO que deseja, 2 segundos, ex.: 2";<br />  read duracao;<br />  <br />  # Cria um diretório temporário que depoi será excluido<br />  mkdir tempdir<br />  <br />  # Informa que está tudo certo<br />  echo "[+] - Transformando o vídeo...aguarde";<br />  <br />  # Faz a conversão<br />  ffmpeg -sameq -ss $tempo -t $duracao -i "$*" tempdir/out%04d.gif 2&gt;/dev/null<br /> <br />  # Nova etapa da conversão<br />  convert -delay 1x25 -loop 0 tempdir/out*.gif tempdir/animacao.gif;<br />  <br />  # Extrai o nome do vídeo que será o mesmo nome pro gif<br />  arquivo=$(echo "$*" | rev | cut -c5- | rev);<br /> <br />  # Otimização da conversão<br />  convert -layers Optimize tempdir/animacao.gif "$arquivo.gif";<br />  <br />  # Se tudo der certo, informará o sucesso da operação<br />  if [ -f "$arquivo.gif" ]; then<br />   echo "Pronto!";<br />  else<br />   echo "Erro ao transformar arquivo em gif, contacte o dsenvolvedor.";<br />  fi<br />  <br />  # Deleta o diretório temporário<br />  [ -d tempdir ] &amp;&amp; rm -rf tempdir;<br /> <br /> # Finaliza a verificação <br /> fi<br /> <br /> # Saída<br /> exit 0<br />}<br /><br /># Chama a função com o parâmetro*<br />_gifconv "$*"<br /></b></pre></div><b></b><b>E só!</b><br /><b></b><b><a href="http://pastebin.com/hC8kqsLw" target="_blank">Vê código no PasteBin</a></b><br /><b></b><b>Esta função/script em Shell/Bash , foi baseada no post:<br />http://xmodulo.com/convert-video-animated-gif-image-linux.html</b>