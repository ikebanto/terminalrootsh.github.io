---
layout: post
title: Tutorial básico de AWK
date: '2014-12-07T05:38:00.003-08:00'
author: Marcos Oliveira
tags:
- AWK
modified_time: '2014-12-07T05:38:25.715-08:00'
thumbnail: http://2.bp.blogspot.com/-udDOCGatbhA/UdDSJZSefbI/AAAAAAAACFo/S9HDtGEQUcc/s72-c/Passaro_Thiele.png
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-8518002890532893741
blogger_orig_url: http://www.terminalroot.com.br/2014/12/tutorial-basico-de-awk.html
---

<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-udDOCGatbhA/UdDSJZSefbI/AAAAAAAACFo/S9HDtGEQUcc/s250/Passaro_Thiele.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-udDOCGatbhA/UdDSJZSefbI/AAAAAAAACFo/S9HDtGEQUcc/s250/Passaro_Thiele.png" /></a></div><br /><br /><h3><span style="clear: left; float: left; font-family: Verdana,sans-serif; font-size: small;"><b><span style="color: #666666;">AWK tem a mesma pronúncia de Auk,<br /> uma espécie de pássaro.</span></b></span></h3><br /><br /><br /><b><span style="font-size: x-large;">Introdução</span></b><br /><blockquote class="tr_bq"><b><span style="color: blue;">AWK</span> é uma <i>linguagem de programação</i> interpretada que é, geralmente, usada para deixar os <strike>scripts de shell mais poderosos</strike> e com mais recursos. É usada mais para processar dados nos textos e operações com arquivos. </b></blockquote><b><br /><span style="font-size: large;">O nome tem origem na primeira letra do sobrenome de cada um dos criadores:</span></b><br /><ul><li><span style="color: purple;"><b>&nbsp;&nbsp;&nbsp; Alfred Aho</b></span></li><span style="color: purple;"></span><li><span style="color: purple;"><b>&nbsp;&nbsp;&nbsp; Peter Weinberger</b></span></li><span style="color: purple;"></span><li><span style="color: purple;"><b>&nbsp;&nbsp;&nbsp; Brian Kernighan</b></span></li></ul><b>&nbsp;&nbsp; <br />Esta linguagem, é considerada por muitos, um importante marco para história da programação, tendo tido bastante influência na criação de outras linguagens de programação, como, por exemplo, <span style="color: blue;">Perl</span> e <span style="color: blue;">Python</span>.<br />&nbsp;&nbsp; <br /><span style="font-size: large;">Variantes do AWK: </span></b><br /><ul><li><span style="color: blue;"><b><span style="color: purple;">BWK</span>: conhecido também AWK ou NAWK se refere à versão por Brian Kernighan .</b></span></li><span style="color: blue;"></span><li><span style="color: blue;"><b><span style="color: purple;">GAWK</span>:(GNU AWK) é outra implementação do software livre (OPEN SOURCE)</b></span></li><span style="color: blue;"></span><li><span style="color: blue;"><b><span style="color: purple;">MAWK</span>:é uma versão muito mais rápida implementação AWK por Mike Brennan</b></span></li><span style="color: blue;"></span><li><span style="color: purple;"><b>(...)</b></span></li></ul><b><br /><span style="font-size: large;">Exemplo 1:</span></b><br /><div class="adp"><b>$ awk '{ print "Hello, World" }'</b></div><b><br /></b><br /><div class="adp"><b>$ awk -f hello.awk</b></div><b><br /><br />A flag "<i>-f</i>" diz que o comando a seguir é um programa a ser executado.<br /><br />Para um programa executável, usar o <span style="color: blue;">/usr/bin/awk</span>.<br /><br />Exemplo, crie um arquivo "<i>world.awk</i>" com o conteúdo:</b><br /><div class="adp"><b><br /></b><b># !/usr/bin/awk -f</b><br /><b># My first awk script</b><br /><b>{ print "Hello, World!" }</b></div><b><br /><br />Tornando este arquivo executável:<br /><br />{% highlight bash %}$ chmod +x world.awk{% endhighlight %}<br /><br />Executando:<br /><br />{% highlight bash %}$ ./world.awk{% endhighlight %}<br /><br /><span style="font-size: large;">Variáveis da Linguagem</span><br /><br />Salve o arquivo: <i>caes.txt</i></b><br /><div class="adp"><b><br /></b><b>rex&nbsp;&nbsp;&nbsp;&nbsp; marelo&nbsp;&nbsp;&nbsp; calmo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; magro</b><br /><b>branco&nbsp; branco&nbsp;&nbsp;&nbsp; zangado&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; magro</b><br /><b>lennon&nbsp; branco&nbsp;&nbsp;&nbsp; brincalhao&nbsp;&nbsp;&nbsp; gordo</b><br /><b>fred&nbsp;&nbsp;&nbsp; branco&nbsp;&nbsp;&nbsp; zangado&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gordo</b></div><b><br /><br />Imprime o arquivo inteiro<br />{% highlight bash %}awk '{print $0}'{% endhighlight %}<br /><div class="adp"><br />&nbsp;&nbsp;&nbsp; $1 imprime o nome do cachorro,<br />&nbsp;&nbsp;&nbsp; $2 a cor,<br />&nbsp;&nbsp;&nbsp; $3 seu humor,<br />&nbsp;&nbsp;&nbsp; $4 seu condicionamento físico. </div><br /><br />Podemos usar essas variáveis dentro do comando print. Nele, sempre que colocamos uma vírgula, estamos espaçando:<br /><br />{% highlight bash %}$ awk '{print "O",$1,"é",$4}' caes.txt{% endhighlight %}<br /><div class="adp"><br />&nbsp;&nbsp;&nbsp; o rex é magro<br />&nbsp;&nbsp;&nbsp; o branco é magro<br />&nbsp;&nbsp;&nbsp; o lennon é gordo<br />&nbsp;&nbsp;&nbsp; o fred é gordo </div><br /><br />{% highlight bash %}$ awk '{print "O"$1"é"$4}' caes.txt{% endhighlight %}<br /><div class="adp"><br />&nbsp;&nbsp;&nbsp; o rexémagro<br />&nbsp;&nbsp;&nbsp; o brancoémagro<br />&nbsp;&nbsp;&nbsp; o lennonégordo<br />&nbsp;&nbsp;&nbsp; o fredégordo </div><br /><br /><span style="font-size: large;">BEGIN</span></b><span style="color: #444444;"><i>Com o begin, o AWK não espera por uma entrada (como digitar ENTER duas vezes), ele executa tudo daquele bloco:</i></span><b><br /><br />{% highlight bash %}$ awk 'BEGIN {print "Vai ser tudo \n imprimido \n de uma vez só\n"}'{% endhighlight %}<br /><div class="adp"><br />&nbsp;&nbsp;&nbsp; Vai ser tudo<br />&nbsp;&nbsp;&nbsp; imprimido<br />&nbsp;&nbsp;&nbsp; de uma vez só</div><br /><br /><span style="font-size: x-large;">Dicas</span><br />&nbsp;&nbsp; </b><br /><ul><li><b>&nbsp;&nbsp; &nbsp; Usamos a flag "-F" pra informar ao AWK que iremos usar a CSV (comma separeted values, valores separados por vírgula).</b></li><li><b>&nbsp;&nbsp; &nbsp; Assim como na linguagem C, AWK também possui o comado "printf", que é bem mais flexível que o "print". A única coisa que o print faz que o printf não faz, é colocar automaticamente uma nova linha ao final da string (\n).{% highlight bash %}$ awk '{ printf "Cor do cachorro %s: %s\n", $1, $2}' caes.txt {% endhighlight %}</b></li><li><b>&nbsp;&nbsp; &nbsp; sprintf: Ela age e tem a mesma sintaxe da "printf". A diferença é que sua saída é armazenada em uma variável, ao invés de ser exibida na tela.</b></li></ul><b>&nbsp;&nbsp; &nbsp; <br /><span style="font-size: x-large;">Variáveis definidas pelo usuário</span><br /><br /><span style="color: purple;"><i>Não pode começar variáveis por dígitos, elas são case sensitivo, não devem ter o mesmo nome das variáveis do AWK, nem de outros comandos e não precisam ser inicializadas ou declaradas.</i></span><br /><br /><u>Ao usar pela primeira uma variável, ela é tanto uma string vazia("") como "0", mas não é muito bom confiar seu script nesses valores iniciais.</u><br /><br /><i>AWK é fracamente tipado, ou seja, você pode atribuir um número a uma variável e sem seguida atribuir uma string, por exemplo.</i><br /><br />Ex.: Salvar como "<i>caes2.awk</i>"</b><br /><div class="adp"><b><br /></b><b>BEGIN { nomecor="%-15s %20s\n"; printf nomecor, "Nome", "Cor\n"}</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { printf nomecor, $1, $2}</b></div><b><br /><br /><span style="font-size: x-large;">if e operadores de comparação</span><br /><br />São as instruções de controle que controlam o fluxo da execução dos programas em AWK. Em AWK, elas são similares as de C, além de possuírem os mesmos loopings e interações do padrão Shell.<br /><br />Elas são: if, while, for, do e similares.<br /><br />Arquivo: <i>gnu.txt</i></b><br /><div class="adp"><b><br /></b><b>Eric&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;59&nbsp; 3&nbsp;&nbsp; 2112</b><br /><b>Linus&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;30&nbsp; 5&nbsp;&nbsp; 578</b><br /><b>Richard&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;40&nbsp; 3&nbsp;&nbsp; 2789</b><br /><b>Marcos&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;24&nbsp; 1&nbsp;&nbsp; 134</b></div><b><br /><br />{% highlight bash %}$ awk '{ if($4 &gt; 2000) print $1 }' gnu.txt{% endhighlight %}<br /><br /><span style="font-size: x-large;">Direcionando a saída</span><br /><br />{% highlight bash %}$ awk 'BEGIN {print 1+1 &gt; "resultado" }'{% endhighlight %}<br /><br />else e else if<br /></b><br /><div class="adp"><b><br /></b><b>#!/usr/bin/awk -f</b><br /><b>{</b><br /><b>&nbsp;&nbsp;&nbsp; if( $1 == "Eric" )</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf "O primeiro\n"</b><br /><b>&nbsp;&nbsp;&nbsp; else if( $1 == "Linus" )</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf "o segundo\n"</b><br /><b>&nbsp;&nbsp;&nbsp; else</b><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf "Ouro cara\n"</b><br /><b>}</b></div><b><br /><br /><i><span style="font-size: x-small;"><span style="color: blue;">Referências</span>:<br />https://pt.wikipedia.org/wiki/Awk<br />http://www.vivaolinux.com.br/artigo/AWK-Introducao<br /><br /><span style="color: blue;">Outros links:</span><br />http://www.zago.eti.br/script/awk.html<br />http://www.lpic.com.br/shell/comandos/awk/print/print.pdf<br />http://www.staff.science.uu.nl/~oostr102/docs/nawk/nawkA4.pdf<br />http://www.faqs.org/faqs/computer-lang/awk/faq/<br />http://www.gnu.org/software/gawk/manual/gawk.html</span></i></b>