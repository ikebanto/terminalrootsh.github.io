---
layout: post
title: Como capturar a senha com TCPDump
date: '2015-07-18T15:37:00.000-07:00'
description: Como capturar a senha com TCPDump
main-class: 'linux'
color: '#3b5998'
author: Marcos Oliveira
tags:
- Linux
- Servidores
- GNU
- Web Hacker
- Redes
modified_time: '2016-03-02T18:00:12.032-08:00'
thumbnail: https://3.bp.blogspot.com/-ZeXzKQo-FR4/VarUFLzgywI/AAAAAAAABgs/cQtKN3Z6mz0/s72-c/capturar-senha-tcpdump.png
twitter_text: Como capturar a senha com TCPDump
introduction: Como capturar a senha com TCPDump
---

<p>
<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-ZeXzKQo-FR4/VarUFLzgywI/AAAAAAAABgs/cQtKN3Z6mz0/s1600/capturar-senha-tcpdump.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="300" src="https://3.bp.blogspot.com/-ZeXzKQo-FR4/VarUFLzgywI/AAAAAAAABgs/cQtKN3Z6mz0/s400/capturar-senha-tcpdump.png" width="400" /></a></div>
<blockquote class="tr_bq" style="background: #ea9999; padding: 10px;"><b>ATENÇÃO:</b>

<p>Esse post NÃO É UMA DICA HACKER(CRACKER)!</p>
<p>Isso serve como conhecimento de proteção, ou seja, alguém que etá usando sua</p>
<p>rede WI-FI por exemplo, ou para ADMINSTRADORES de rede que estão monitorando</p>
<b>tráfego e maus usuários!!!</b></blockquote><b>
O <span style="font-size: large;"><a href="http://www.tcpdump.org/" target="_blank"><span style="color: blue;">tcpdump</span></a></span> é uma ferramenta utilizada para monitorar os pacotes trafegados numa rede de computadores. Ela mostra os cabeçalhos dos pacotes que passam pela interface de rede.

Se você não possui o TCPDump, use o gerenciador de pacotes correspondente da sua distro para instalá-lo, o baixe aqui e compile-o.

Instalação num máquina com <a href="https://www.debian.org/" target="_blank"><span style="font-size: large;"><span style="color: blue;">GNU/Linux Debian</span></span></a>:

{% highlight bash %}
$ su
# apt-get install tcpdump
{% endhighlight %}

Aqui eu fiz um teste utilizando a seguinte estrutura:

  </b>
<div class="separator" style="clear: both; text-align: center;"><b><a href="http://1.bp.blogspot.com/-f538su35Ocs/VarRtAS2kQI/AAAAAAAABgg/eOH7kh-wtNE/s1600/capturando.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="340" src="https://1.bp.blogspot.com/-f538su35Ocs/VarRtAS2kQI/AAAAAAAABgg/eOH7kh-wtNE/s640/capturando.gif" width="640" /></a></b></div><b>    

O <span style="color: blue;">Notebook</span> que possui o endereço <span style="color: blue;">192.168.1.3</span> acessará o <span style="color: purple;">PC 192.168.1.2</span> que possui o formulário, o mesmo <a href="http://www.terminalroot.com.br/2015/07/shell-script-enviando-dados-via.html" target="_blank"><span style="font-size: large;"><span style="color: blue;">formulário criado nesse post</span></span></a>. A "ponte"(Gateway) para essa comunicação é um <span style="color: red;">Modem/Roteador 192.168.1.1 </span>, mesmo sem internet, ele iria permitir essa comunicação (lógico :P).

No PC vou setar o comando do TCPDump para capturar o pacote e salvar os dados num arquivo que eu chamei de </b><span style="color: orange;"><i>pegandoasenha-tcpdump.txt</i></span><b> (<i>já deixei até o arquivo aberto, e só cliquei em recarregar para mostrar os dados do arquivo modificado</i>). Então já rodei o comando e o TCPDump ficou aguardando os pacotes que o Notebook(192.168.1.3) estava enviando para o PC(192.168.1.2).

<u><i>Se o PC fosse o Gateway, também dava pra pegar os dados que estava sendo enviado, pois estaria passando pelo PC, ou seja, pra você pegar os dados que estão passado pelo seu Roteador, você precisa configurá-lo com o TCPDump, blz?! O proxy também faz isso, mas isso aqui é só um teste pra saber a utulização do TCPDump! :)</i></u>

<span style="font-size: large;">No PC o comando utilizado pra isso foi:</span>

{% highlight bash %}
 tcpdump -nAs0 -i eth0 'port 80' >> pegandoasenha-tcpdump.txt 
{% endhighlight %}
-n Não converter endereços (ou seja, endereços de hosts, números de portas, etc.) para nomes.-A Imprimir cada pacote (menos seu cabeçalho ) em ASCII. Para a captura de páginas da web.-s Ver todos os dados da captura-i Interface de rede, no meu caso é a eth0'port 80' HTTPpegandoasenha-tcpdump.txt Arquivo que eu quero salvar os dados, mas se eu não utilizasse redirecionador(>>) , ele mostraria na tela!
Após eu dar enter nesse comando, o TCPDump capturará todas as requisições que passem pelo meu IP. Então fui lá no Notebook e enviei os dados para o formulário. Utilizei: 

Nome de usuário: pegar a senha

e a senha:

Senha: facil ok

Depois fui ver o arquivo e estava lá a senha.

O arquivo possui vários dados (Navegador, IP, hora, data,...) ex.:
  
17:40:37.142723 IP 192.168.1.3.55480 > 192.168.1.2.80: Flags [S], seq 881644111, win 29200, options [mss 1460,sackOK,TS val 662693 ecr 0,nop,wscale 7], length 0
E..<..@.@..{...........P4..O......r.V..........
.
..........
17:40:37.142778 IP 192.168.1.2.80 > 192.168.1.3.55480: Flags [S.], seq 3895379345, ack 881644112, win 28960, options [mss 1460,sackOK,TS val 1618431 ecr 662693,nop,wscale 7], length 0
E..<..@.@..f.........P......4..P..q ...........
.....
......
17:40:37.167604 IP 192.168.1.3.55480 > 192.168.1.2.80: Flags [.], ack 1, win 229, options [nop,nop,TS val 662694 ecr 1618431], length 0
E..4..@.@..............P4..P...............
.
......
17:40:37.167833 IP 192.168.1.3.55480 > 192.168.1.2.80: Flags [P.], seq 1:499, ack 1, win 229, options [nop,nop,TS val 662694 ecr 1618431], length 498
E..&amp;..@.@..............P4..P...............
.
......POST /formulario.php HTTP/1.1
Host: 192.168.1.2
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:31.0) Gecko/20100101 Firefox/31.0 Iceweasel/31.7.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://192.168.1.2/formulario.php
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 53

nome=pegar+a+senha&amp;senha=facil+ok&amp;enviar=Enviar+dados
17:40:37.167879 IP 192.168.1.2.80 > 192.168.1.3.55480: Flags [.], ack 499, win 235, options [nop,nop,TS val 1618437 ecr 662694], length 0
E..4w.@.@.?..........P......4..B...........
.....
..
17:40:37.170762 IP 192.168.1.2.80 > 192.168.1.3.55480: Flags [P.], seq 1:230, ack 499, win 235, options [nop,nop,TS val 1618438 ecr 662694], length 229
E...w.@.@.>..........P......4..B...........
.....
..HTTP/1.1 200 OK
Date: Sat, 18 Jul 2015 20:40:37 GMT
Server: Apache/2.4.10 (Debian)
Content-Length: 25
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

Dados salvos com sucesso!
17:40:37.171716 IP 192.168.1.3.55480 > 192.168.1.2.80: Flags [.], ack 230, win 237, options [nop,nop,TS val 662701 ecr 1618438], length 0
E..4..@.@..............P4..B...w.....&amp;.....
.
......
17:40:42.173212 IP 192.168.1.3.55480 > 192.168.1.2.80: Flags [F.], seq 499, ack 230, win 237, options [nop,nop,TS val 663951 ecr 1618438], length 0
E..4..@.@..............P4..B...w.....C.....
.
!.....
17:40:42.173326 IP 192.168.1.2.80 > 192.168.1.3.55480: Flags [F.], seq 230, ack 500, win 235, options [nop,nop,TS val 1619689 ecr 663951], length 0
E..4w.@.@.?..........P.....w4..C.....a.....
.....
!.
17:40:42.174337 IP 192.168.1.3.55480 > 192.168.1.2.80: Flags [.], ack 231, win 237, options [nop,nop,TS val 663951 ecr 1619689], length 0
E..4..@.@..~...........P4..C...x....._.....
.
!.....

A linha correspondente que mostra os dados que possui a senha é:    

{% highlight bash %}
nome=pegar+a+senha&amp;senha=facil+ok&amp;enviar=Enviar+dados
{% endhighlight %}
 <!-- 
<span style="color: blue;"><span style="font-size: x-large;">Veja o vídeo abaixo que mostra como tudo foi feito:</span></span>

 <iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/jFXv4YBDmS0" width="420"></iframe>-->

Você pode aumentar sua produtividade utilizando mais informações, existe várias opções para o TCPDump:

Exemplo de comando tcpdump para mostrar quais as ligações de um determinado endereço tcp-ip à porta 80 do seu servidor: tcpdump -ni eth0 src "numero ip" and dst port 80

{% highlight bash %}
tcpdump -i eth0
{% endhighlight %}

Conexões de origem podem ser monitoradas utilizando o parâmetro src host, um exemplo simples seria monitorarmos o tráfego que vem de 192.168.1.9 para nosso computador, com o ip 192.168.1.2. A linha de comando ficaria da seguinte forma:

{% highlight bash %}
tcpdump -i eth0 src host 192.168.1.9
{% endhighlight %}

Se quisermos monitorar as conexões especificando um host de destino, poderíamos fazê-lo com o parâmetro dst host, o exemplo abaixo mostra todo o tráfego do host 192.168.1.2 com 192.168.1.1, no caso, 192.168.1.1 é nosso gateway.

{% highlight bash %}
tcpdump -i eth0 dst host 192.168.1.1
{% endhighlight %}

Mais:
http://www.tcpdump.org/
https://pt.wikipedia.org/wiki/Tcpdump
http://www.imartins.com.br/informix/artigos/capturando-senha-usuarios


