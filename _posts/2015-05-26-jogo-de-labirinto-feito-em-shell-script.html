---
layout: post
title: Jogo de labirinto feito em shell script
date: '2015-05-26T18:01:00.000-07:00'
author: Marcos Oliveira
tags:
- Games
- Terminal
modified_time: '2015-05-26T18:01:35.369-07:00'
thumbnail: http://1.bp.blogspot.com/-nkW2LcvPRYE/VWUXAhzfAnI/AAAAAAAABSw/VpX95QLGnqM/s72-c/larinto-shell.png
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-8987488768184291691
blogger_orig_url: http://www.terminalroot.com.br/2015/05/jogo-de-labirinto-feito-em-shell-script.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-nkW2LcvPRYE/VWUXAhzfAnI/AAAAAAAABSw/VpX95QLGnqM/s1600/larinto-shell.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-nkW2LcvPRYE/VWUXAhzfAnI/AAAAAAAABSw/VpX95QLGnqM/s320/larinto-shell.png" /></a></div><b>Este jogo possui fases aleatórias e seleção do nível de dificuldade.<br /> Foi baseado no gerador aleatório de labirintos de Joe Wingbermuehle localizado em: <a href="https://raw.github.com/joewing/maze/master/maze.sh" rel="nofollow" target="_blank">https://raw.github.com/joewing/maze/master/maze.sh</a><br />Acrescentei o conceito de movimento e colisões para criar o jogo.<br /> Naturalmente uma linguagem compilada deve ser mais eficiente para  este tipo de uso, porém esse joguinho serve para mostrar o poder nem  sempre reconhecido do shell script.<br /> Download: <a href="http://pastebin.com/download.php?i=rQdJ43Nw" target="_blank">clique aqui para baixar o script labirinto.sh</a><br /> Código:<br /> </b><br /><div class="adp"><b>#!/bin/bash</b><br /><b>#</b><br /><b>#</b><br /><b># Bash Labirinto versão 1.0</b><br /><b># Este jogo foi baseado no gerador aleatório de labirintos de</b><br /><b># Joe Wingbermuehle localizado em&nbsp; https://raw.github.com/joewing/maze/master/maze.sh</b><br /><b># Acrescentei o conceito de movimento e colisões para criar o jogo.</b><br /><b># Naturalmente uma linguagem compilada deve ser mais eficiente para este tipo de uso,</b><br /><b># porém esse joguinho serve para mostrar o poder nem sempre reconhecido do shellscript.</b><br /><b>#</b><br /><b>#</b><br /><b># Referências e códigos utilizados:</b><br /><b># https://raw.github.com/joewing/maze/master/maze.sh</b><br /><b># http://lendscripts.blogspot.com.br/2012/10/licao-3-programacao-de-jogos-em.html</b><br /><b>#</b><br /><b># Escrito por Fernando Bolonhezi Giannasi – junho/2013# Validar versão do Bash</b><br /><b>if [ $(echo $BASH_VERSION | awk -F”.” ‘{ if ( ($1 &gt;= 4) ) {print “0”} else {print “1”}}’) -ne “0” ]; then</b><br /><b>echo “Este jogo só funciona com Bash 4.0 ou posterior”</b><br /><b>echo “Sua versão é $BASH_VERSION”</b><br /><b>exit 1</b><br /><b>fi # Menu inicial</b><br /><b>setterm -cursor off</b><br /><b>while true; do</b><br /><b>clear</b><br /><b>echo -e ’33[01;33m’</b><br /><b>cat &lt;&lt; EOF</b><br /><b>Labirinto Bash versão 1.0</b><br /><b>*******************************************</b><br /><b>Ajude a bolota vermelha a encontrar a saída</b><br /><b>*******************************************</b><br /><b>Comandos:</b><br /><b>a -&gt; move a esquerda</b><br /><b>s -&gt; move abaixo</b><br /><b>d -&gt; move a direita</b><br /><b>w -&gt; move acima</b><br /><b>q -&gt; sai do jogo (a qualquer momento)</b><br /><b>*******************************************</b><br /><b>EOF</b><br /><b>tput sgr0</b><br /><b>echo -e ’33[01;31m’</b><br /><b>cat &lt;&lt; EOF</b><br /><b>Selecione a dificuldade desejada:</b><br /><b>1-) Fácil</b><br /><b>2-) Médio</b><br /><b>3-) Difícil</b><br /><b>q-) Sair do Jogo</b><br /><b>EOF</b><br /><b>tput sgr0</b><br /><b>read -n1 -s DIFICULDADE</b><br /><b>case “$DIFICULDADE” in</b><br /><b>“1”)</b><br /><b>MAZE_WIDTH=”39″</b><br /><b>MAZE_HEIGHT=”21″</b><br /><b>break</b><br /><b>;;</b><br /><b>“2”)</b><br /><b>MAZE_WIDTH=”49″</b><br /><b>MAZE_HEIGHT=”31″</b><br /><b>break</b><br /><b>;;</b><br /><b>“3”)</b><br /><b>MAZE_WIDTH=”59″</b><br /><b>MAZE_HEIGHT=”41″</b><br /><b>break</b><br /><b>;;</b><br /><b>“q”)</b><br /><b>exit 0</b><br /><b>;;</b><br /><b>esac</b><br /><b>done</b><br /><b># Gerador de labirintos:</b><br /><b># Initialize the maze array.</b><br /><b>function init_maze {</b><br /><b>for ((y=0; y&lt;MAZE_HEIGHT; y++)) ; do</b><br /><b>for ((x=1; x&lt;$((MAZE_WIDTH-1)); x++)) ; do</b><br /><b>maze[$((y * MAZE_WIDTH + x))]=0</b><br /><b>done</b><br /><b>maze[$((y * MAZE_WIDTH + 0))]=1</b><br /><b>maze[$((y * MAZE_WIDTH + (MAZE_WIDTH – 1)))]=1</b><br /><b>done</b><br /><b>for ((x=0; x&lt;MAZE_WIDTH; x++)) ; do</b><br /><b>maze[$x]=1</b><br /><b>maze[$(((MAZE_HEIGHT – 1) * MAZE_WIDTH + x))]=1</b><br /><b>done</b><br /><b>}</b><br /><b># Display the maze array.</b><br /><b>function print_maze {</b><br /><b>for ((y=0; y&lt;MAZE_HEIGHT; y++)) ; do</b><br /><b>for ((x = 0; x &lt; MAZE_WIDTH; x++ )) ; do</b><br /><b>if [[ maze[$((y * MAZE_WIDTH + x))] -eq 0 ]] ; then</b><br /><b>echo -n “[]”</b><br /><b>else</b><br /><b>echo -n ”&nbsp; ”</b><br /><b>fi</b><br /><b>done</b><br /><b>echo</b><br /><b>done</b><br /><b>}</b><br /><b># Carve the maze starting at the specified offset.</b><br /><b>function carve_maze {</b><br /><b>local index=$1</b><br /><b>local dir=$RANDOM</b><br /><b>local i=0</b><br /><b>maze[$index]=1</b><br /><b>while [ $i -le 4 ] ; do</b><br /><b>local offset=0</b><br /><b>case $((dir % 4)) in</b><br /><b>0) offset=1 ;;</b><br /><b>1) offset=-1 ;;</b><br /><b>2) offset=$MAZE_WIDTH ;;</b><br /><b>3) offset=$((-$MAZE_WIDTH)) ;;</b><br /><b>esac</b><br /><b>local index2=$((index + offset))</b><br /><b>if [[ maze[$index2] -eq 0 ]] ; then</b><br /><b>local nindex=$((index2 + offset))</b><br /><b>if [[ maze[$nindex] -eq 0 ]] ; then</b><br /><b>maze[$index2]=1</b><br /><b>carve_maze $nindex</b><br /><b>i=0</b><br /><b>dir=$RANDOM</b><br /><b>index=$nindex</b><br /><b>fi</b><br /><b>fi</b><br /><b>i=$((i + 1))</b><br /><b>dir=$((dir + 1))</b><br /><b>done</b><br /><b>}</b><br /><b># Gera um labirinto:</b><br /><b>TMP=”/tmp”</b><br /><b>if [ ! -d “$TMP” ]; then</b><br /><b>mkdir “$TMP”</b><br /><b>fi</b><br /><b>init_maze</b><br /><b>carve_maze $((2 * MAZE_WIDTH + 2))</b><br /><b>maze[$((MAZE_WIDTH + 2))]=1</b><br /><b>maze[$(((MAZE_HEIGHT – 2) * MAZE_WIDTH + MAZE_WIDTH – 3))]=1</b><br /><b>print_maze &gt; $TMP/maze.txt</b><br /><b>sed -i ‘1d’ $TMP/maze.txt</b><br /><b>sed -i ‘s/^&nbsp; //g’ $TMP/maze.txt</b><br /><b># Inicializando variáveis</b><br /><b>INPUT=”0″ # Entrada de dados</b><br /><b>m=”0″ # Movimento 1</b><br /><b>n=”1″ # Movimento 2</b><br /><b>C=”0″ # Teste de colisões</b><br /><b>x=”3″ # Coordenada x</b><br /><b>y=”0″ # Coordenada y</b><br /><b>counter=”1″ #Conta movimentos</b><br /><b>GANHA=”$(echo $MAZE_HEIGHT – 3 | bc)” # Detecta local da saída</b><br /><b>#Funções para imprimir labirinto e a bola</b><br /><b>function cat_maze() {</b><br /><b>echo -ne ’33[01;32m’</b><br /><b>cat $TMP/maze.txt</b><br /><b>tput sgr0</b><br /><b>echo “Coordenada X = $x”</b><br /><b>echo “Coordenada Y = $y”</b><br /><b>echo “Movimentos = $counter”</b><br /><b>}</b><br /><b>function cat_ball() {</b><br /><b>echo -ne ’33[01;31m’O</b><br /><b>tput sgr0</b><br /><b>}</b><br /><b># Posição inicial</b><br /><b>clear</b><br /><b>tput cup 0 0</b><br /><b>cat_maze</b><br /><b>tput cup $y $x</b><br /><b>cat_ball</b><br /><b>#Movimentação da bola:</b><br /><b>while [ $INPUT != “q” ];do</b><br /><b>read&nbsp; -n1 -s INPUT</b><br /><b>if [ $INPUT = a ];then</b><br /><b>let “m = x”</b><br /><b>let “n = y + 1″</b><br /><b>C=$(cat $TMP/maze.txt | sed -n “$n”p 2&gt; /dev/null | cut -c”$m” 2&gt;  /dev/null) # Se C não estiver vazio então atingimos uma parede</b><br /><b>if [ -z $C ];then</b><br /><b>let “x = x – 1″</b><br /><b>else</b><br /><b>let counter–</b><br /><b>fi</b><br /><b>fi</b><br /><b>if [ $INPUT = d ];then</b><br /><b>let “m = x + 2″</b><br /><b>let “n = y + 1″</b><br /><b>C=$(cat $TMP/maze.txt | sed -n “$n”p 2&gt; /dev/null | cut -c”$m” 2&gt;  /dev/null) # Se C não estiver vazio então atingimos uma parede</b><br /><b>if [ -z $C ];then</b><br /><b>let “x = x + 1″</b><br /><b>else</b><br /><b>let counter–</b><br /><b>fi</b><br /><b>fi</b><br /><b>if [ $INPUT = w ];then</b><br /><b>let “m = x + 1″</b><br /><b>let “n = y”</b><br /><b>C=$(cat $TMP/maze.txt | sed -n “$n”p 2&gt; /dev/null | cut -c”$m” 2&gt;  /dev/null) # Se C não estiver vazio então atingimos uma parede</b><br /><b>if [ -z $C ];then</b><br /><b>let “y = y – 1″</b><br /><b>else</b><br /><b>let counter–</b><br /><b>fi</b><br /><b>fi</b><br /><b>if [ $INPUT = s ];then</b><br /><b>let “m = x + 1″</b><br /><b>let “n = y + 2″</b><br /><b>C=$(cat $TMP/maze.txt | sed -n “$n”p 2&gt; /dev/null | cut -c”$m” 2&gt;  /dev/null) # Se C não estiver vazio então atingimos uma parede</b><br /><b>if [ -z $C ];then</b><br /><b>let “y = y + 1″</b><br /><b>else</b><br /><b>let counter–</b><br /><b>fi</b><br /><b>fi</b><br /><b>if [ “$y” -lt “0” ]; then y=0; let counter–; fi</b><br /><b># Checa se ganhou</b><br /><b>if [ “$y” -gt “$GANHA” ]; then</b><br /><b>tput cup $(echo $MAZE_HEIGHT + 3 | bc) 0</b><br /><b>echo -e ’33[01;31m’</b><br /><b>echo GANHOU!!!!!</b><br /><b>echo “Score: $counter movimentos realizados”</b><br /><b>tput sgr0</b><br /><b>echo</b><br /><b>setterm -cursor on</b><br /><b>exit 0</b><br /><b>fi</b><br /><b>clear</b><br /><b>cat_maze</b><br /><b># Imprime a bola na nova localização</b><br /><b>tput cup $y $x</b><br /><b>cat_ball</b><br /><b>let counter++</b><br /><b>done</b><br /><b>clear</b><br /><b># Fim do script</b></div>Via: http://www.vivaolinux.com.br/script/Jogo-de-labirinto-feito-em-shell-script