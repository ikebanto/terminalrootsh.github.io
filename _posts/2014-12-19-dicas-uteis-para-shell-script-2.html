---
layout: post
title: Dicas úteis para Shell Script 2
date: '2014-12-19T12:57:00.000-08:00'
description: Dicas úteis para Shell Script 2
main-class: 'bash'
color: '#c2003a'
author: Marcos Oliveira
tags:
- Shell Script
- Dicas
modified_time: '2014-12-19T12:57:52.339-08:00'
thumbnail: http://1.bp.blogspot.com/-FkPcIsY-8fU/Ub4bRVwYWsI/AAAAAAAAB6I/UlsSTr0GR6s/s72-c/shell+script.png
twitter_text: Dicas úteis para Shell Script 2
introduction: Dicas úteis para Shell Script 2
---

<p>
</p><p><div style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-FkPcIsY-8fU/Ub4bRVwYWsI/AAAAAAAAB6I/UlsSTr0GR6s/s200/shell+script.png" height="200" width="200" /></div></p><p></p><p><blockquote class="tr_bq"><b>Digitar Script no terminal utilizando <span style="color: blue;">EOF</span> (<span style="font-size: x-small;"><i>End Of File</i></span>), serve para agilizar digitalização de qualquer coisa e já salvar via terminal, para finalizar, basta escrever em maiúsculo: <span style="color: blue;">EOF</span> e pressionar <span style="color: purple;">[ENTER]</span>, pode-se usar <span style="color: blue;">EOS</span> (<span style="font-size: x-small;"><i>End Of System</i></span>) ou <span style="color: blue;">EOL</span> (<span style="font-size: x-small;"><i>End Of Line</i></span>) também e finalizar com <span style="color: blue;">EOS</span> <span style="color: purple;">[ENTER]</span> ou <span style="color: blue;">EOL </span><span style="color: purple;">[ENTER]</span>, da mesma forma ou diferente como apresentada abaixo:</b></blockquote><b></p><p>{% highlight bash %}</p><p>$ cat &lt;&lt; EOF &gt;&gt; condicao_ternaria.sh</p><p>&gt; #!/bin/bash</p><p>&gt; ping -c1 www.linux.org &amp;&amp; echo 'Rede OK' || echo 'Rede Sujou.'</p><p>&gt; EOF{% endhighlight %}</p><p></p><p><u><i>utilizando o<span style="color: blue;"> EOS</span> e uma <span style="color: blue;">condição ternária</span> com somente mensagens</i></u></p><p>{% highlight bash %}</p><p>$ cat &gt; condicao_ternaria_2_so_msg.sh &lt;&lt; EOS</p><p>&gt; #!/bin/bash</p><p>&gt; ping -c1 www.linux.org 2&gt;/dev/null 1&gt;/dev/null &amp;&amp; echo 'Rede OK' ||\ echo 'Rede Sujou.'</p><p>&gt; EOS{% endhighlight %}</p><p></p><p><i>Criando um arquivo <span style="color: blue;">sh</span> instantâneo, utilizando o <span style="color: blue;">EOL</span> e o comando <span style="color: blue;">trap</span></i></p><p>{% highlight bash %}</p><p>$ sh &lt;&lt; EOL</p><p>&gt; # funções tambem podem ser chamadas usando: function funcao(){}</p><p>&gt; # trap é o mesmo CTRL+C</p><p>&gt;&nbsp; function trataErro()</p><p>&gt;&nbsp; {</p><p>&gt;&nbsp; echo "Voce pressionou ctrl-c"</p><p>&gt;&nbsp; echo "Mas nao posso terminar agora"</p><p>&gt;&nbsp; }</p><p>&gt; </p><p>&gt;&nbsp; trap trataErro SIGINT SIGTERM</p><p>&gt; </p><p>&gt;&nbsp; for i in {1..10}</p><p>&gt;&nbsp; do</p><p>&gt;&nbsp;&nbsp; sleep 1</p><p>&gt;&nbsp;&nbsp; echo "Dormindo"</p><p>&gt;&nbsp; done</p><p>&gt; EOL{% endhighlight %}</p><p>&nbsp;</b></p><p><b><span style="font-size: x-large;">Truques para tratamento de variáveis em shell script</span></b></p><p><blockquote class="tr_bq"><b>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;As variáveis do sistema servem para armazenar algum valor (como toda variável), mas existem alguns recursos interessantes e úteis no modo de usar tais variáveis. O que aprendemos em alguns tutoriais, é que para declarar uma variável do sistema, fazemos:</b></blockquote><b>&nbsp;&nbsp; &nbsp;</b></p><p><div class="adp"><b></p><p></b><b>&nbsp;&nbsp; &nbsp;NOME="VALOR" &gt; Aqui podemos usar valores de outras variáveis</b></p><p><b>&nbsp;&nbsp; &nbsp;NOME='VALOR' &gt; NOME terá o valor igual a VALOR</b></p><p><b>&nbsp;&nbsp; &nbsp;NOME=`COMANDO` &gt; NOME terá o valor da saída de comando</b></p><p><b>&nbsp;&nbsp; &nbsp;</b></div><b></p><p>&nbsp;&nbsp; &nbsp;Isto é o básico, agora teremos algumas coisas mais interessantes:</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">1. Retirar parte final de uma string</span></span></p><p>&nbsp;&nbsp; &nbsp;</b></p><p><div class="adp"><b></p><p></b><b>&nbsp;&nbsp; &nbsp;VAR="minha_foto.jpeg"</b></p><p><b>&nbsp;&nbsp; &nbsp;echo ${VAR%.jpeg}</b></p><p><b>&nbsp;&nbsp; &nbsp;</b></div><b></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: minha_foto</span></p><p></p><p>&nbsp;&nbsp; &nbsp;<i>Como podemos ver, ".jpeg" será excluído. Indicamos o que será excluído depois do caracter '%'.</i></p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">2. Retirar da variável a parte inicial do valor dado</span></span></p><p>&nbsp;&nbsp; &nbsp;</b></p><p><div class="adp"><b></p><p></b><b>&nbsp;&nbsp; &nbsp;VAR="http://www.vivaolinux.com.br"</b></p><p><b>&nbsp;&nbsp; &nbsp;echo ${VAR#http://}</b></p><p><b>&nbsp;&nbsp; &nbsp;</b></div><b></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: www.vivaolinux.com.br</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Indicamos o que será excluído depois do caracter '#'</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">3. Mostrar tudo depois de uma certa posição</span></span></p><p>&nbsp;&nbsp; &nbsp;</b></p><p><div class="adp"><b></p><p></b><b>&nbsp;&nbsp; &nbsp;VAR="http://www.g00gle.com"</b></p><p><b>&nbsp;&nbsp; &nbsp;echo ${VAR:7}</b></p><p><b>&nbsp;&nbsp; &nbsp;</b></div><b></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: www.g00gle.com</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Depois do ':' indicamos o índice. Como é em C, o primeiro índice é 0, o segundo é 2 ..., o oitavo é 7 ... etc.</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">4. Mostrar entre alguns caracteres</span></span></p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;VAR="123456789"</p><p>&nbsp;&nbsp; &nbsp;echo ${VAR:2:5}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: 34567</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Primeiro, faz-se o índice 2, que começa no caracter '3'. No índice 5, a contagem já começa no índice 2 (5 caracteres a partir do índice 2), aí morre no caracter '7'.</p><p></p><p>&nbsp;&nbsp; <span style="color: blue;"><span style="font-size: large;">&nbsp;5. Elimina o caracter mostrado e tudo a ESQUERDA</span></span></p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;VAR="daemonio@vivaolinux"</p><p>&nbsp;&nbsp; &nbsp;echo ${VAR#*@}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: vivaolinux</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Bom, aqui indicamos o caracter a ser deletado e tudo a sua esquerda, depois da string "#*".</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">6. Elimina o caracter mostrado e tudo a DIREITA</span></span></p><p></p><p>&nbsp;&nbsp; &nbsp;Como o mundo não é feito somente de canhotos,</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;VAR="daemonio@vivaolinux"</p><p>&nbsp;&nbsp; &nbsp;echo ${VAR%@*}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: daemonio</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Já aqui, indicamos o caracter a ser deletado e tudo a sua direita, entre a string "%*".</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">7. Excluir até um certo valor</span></span></p><p></p><p>&nbsp;&nbsp; &nbsp;Esta daqui é igual ao de cima, só que podemos indicar strings ao invés de somente um caracter.</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;EXC=":senha"</p><p>&nbsp;&nbsp; &nbsp;VAR="root:senha:/bin/bash"</p><p></p><p>&nbsp;&nbsp; &nbsp;echo ${VAR%%$EXC*}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: root</span></p><p></p><p>&nbsp;&nbsp; &nbsp;O que será excluído tem que ficar entre "%%" e '*'.</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">8. Excluir de um certo valor até o final</span></span></p><p></p><p>&nbsp;&nbsp; &nbsp;Agora é ao contrário, exclui até o final.</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;EXC="senha:"</p><p>&nbsp;&nbsp; &nbsp;VAR="root:senha:/bin/bash"</p><p></p><p>&nbsp;&nbsp; &nbsp;echo ${VAR##*$EXC}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: /bin/bash</span></p><p></p><p>&nbsp;&nbsp; &nbsp;O que será excluído deve ficar depois do "##*".</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">9. Troca-troca (de strings :-)</span></span></p><p></p><p>&nbsp;&nbsp; &nbsp;Isto na verdade funfa que nem o comando sed.</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;VAR="c1:c2:c3"</p><p>&nbsp;&nbsp; &nbsp;echo ${VAR/:/x}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: c1xc2:c3</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Troca a primeira ocorrência de ':' por 'x', para trocar tudo:</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;echo ${VAR//:/x}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;Usa-se duas barras.</p><p></p><p>&nbsp;&nbsp; &nbsp;Nada impede de trocar por strings:</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;echo ${VAR//:/-CC-}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: c1-CC-c2-CC-c3</span></p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">10. Mostrar o comprimento da variável:</span></span></p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;VAR="tenho 19 caracteres"</p><p>&nbsp;&nbsp; &nbsp;echo ${#VAR}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: 19</span></p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">11. Listar nomes de variáveis</span></span></p><p></p><p>&nbsp;&nbsp; &nbsp;Para listar todas as variáveis de seu sistema que contenha tal nome, faça:</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;echo ${!va*}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;Mostrará todas as variáveis que começam com "va". Aí pode sair: vaca, vacuo, vassoura, etc.</p><p></p><p>&nbsp;&nbsp; &nbsp;<span style="color: blue;"><span style="font-size: large;">12. Um ou outro</span></span></p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;echo ${VAR:-"eu não existo"}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: eu não existo</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Se VAR for nula, mostra "eu não existo", se não for nula, mostra o conteúdo dela.</p><p>&nbsp;&nbsp; &nbsp;<div class="adp"></p><p>&nbsp;&nbsp; &nbsp;VAR="eu existo"</p><p>&nbsp;&nbsp; &nbsp;echo ${VAR:-"eu não existo"}</p><p>&nbsp;&nbsp; &nbsp;</div></p><p>&nbsp;&nbsp; &nbsp;<span style="color: purple;">Saída: eu existo</span></p><p></p><p>&nbsp;&nbsp; &nbsp;Agora, VAR não é nula, por isto mostra o conteúdo dela.</p><p>&nbsp;&nbsp; </p><p>&nbsp;&nbsp; &nbsp;Fonte: <a href="http://www.vivaolinux.com.br/dica/Truques-para-tratamento-de-variaveis-em-shell-script" target="_blank">http://www.vivaolinux.com.br/dica/Truques-para-tratamento-de-variaveis-em-shell-script</a></p><p>&nbsp;&nbsp; </b></p><p><blockquote class="tr_bq"><b><span style="font-size: x-large;">Variáveis ambientes 2 caracteres</span></b></blockquote><b></p><p> <table border="1"><tbody><tr><td>Variável</td><td>Descrição</td></tr><tr><td>$0</td><td>Parâmetro número 0 (nome do comando ou função)</td></tr></tbody></table></b></p><p>$1</p><p>Parâmetro número 1 (da linha de comando ou função)</p><p> …</p><p>Parâmetro número N …</p><p> $9</p><p>Parâmetro número 9 (da linha de comando ou função)</p><p> ${10}</p><p>Parâmetro número 10 (da linha de comando ou função)</p><p> $</p><p>Número total de parâmetros da linha de comando ou função</p><p> $*</p><p>Todos os parâmetros, como uma string única</p><p> $@</p><p>Todos os parâmetros, como várias strings protegidas</p><p> $$</p><p>Número PID do processo atual (do próprio script)</p><p> $!</p><p>Número PID do último processo em segundo plano</p><p> $_</p><p>Último argumento do último comando executado</p><p> $?</p><p>Valor de retorno do último comando executado</p><p>       

</p>
