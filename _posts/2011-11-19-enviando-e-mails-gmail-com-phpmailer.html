---
layout: post
title: Enviando E-Mails (Gmail) com PHPMailer
date: '2011-11-18T18:18:00.000-08:00'
author: The Bang Bash
tags:
- PHP
modified_time: '2013-05-03T07:16:09.992-07:00'
blogger_id: tag:blogger.com,1999:blog-2422865715758349944.post-8032499071168063105
blogger_orig_url: http://www.terminalroot.com.br/2011/11/enviando-e-mails-gmail-com-phpmailer.html
---

&nbsp; <b>Eu utilizei essa classe<span style="color: lime;"> </span><i style="color: #274e13;"><strike>hoje</strike></i> pra configurar minha página de contato aqui do Blog, <a href="http://marcospinguim.blogspot.com/p/contato.html" target="_blank"><span style="color: blue;">CLIQUE AQUI</span></a> para ver a página(<span style="color: red;">Obs.:essa página tem JQueri e está hospedada em outro lugar, pois o blogger não executa o PHP aqui e muito menos hospeda arquivos, chamei com um FRAME pra cá</span>).</b><br /><b><br />A classe <span style="color: orange;">PHPMailer</span> serve para envio de e-mails através do PHP via conexão SMTP ou POP3 muito utilizado por todo o mundo. Seu método de envio é largamente recomendado e é bem melhor do que o envio do mail() ou sendmail() ambas do PHP.</b><br /><br /><b>Esse processo é bem simples, e nesse caso vamos configurar também o envio de resposta pra quem preencheu o formulário.</b><br /><b>Separei em dos arquivos, mas costumo usar tudo num só arquivo, os dois arquivos serão:</b><br /><br /><br /><blockquote class="tr_bq"><b>index.php</b><br /><b> enviar.php</b></blockquote><br />&nbsp;<b>Usarei como exemplo um e-mail do Gmail, primeiramente temos de baixar a classe PHPMailer do site e descompactá-la no local onde</b><br /><b>está os arquivos criados aqui.</b><br /><br /><b><a href="http://sourceforge.net/projects/phpmailer/files/phpmailer%20for%20php5_6/" style="color: blue;" target="_blank">Clique aqui</a> para efetuar o download da classe PHPMailer, baixei o arquivo <a href="http://sourceforge.net/projects/phpmailer/files/phpmailer%20for%20php5_6/" style="color: blue;" target="_blank">PHPMailer v5.1</a></b><br /><br /><b>Agora vamos construir nosso index.php que estará nosso form(nao usei tableless nesse exemplo, nem tá completo o arquivos faltando as tags de uma página HTML).</b><br /><b>Leia os cometários em AZUL para compreender a ação.Qualquer dúvida é só comentar.</b><br />{% highlight bash %}<br /><b>&lt;table border="1"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">&lt;!--Informamos o arquivo PHP que irá processar o form e o método de envio, o POST--&gt;</span><br />&nbsp;&nbsp;&nbsp; &lt;form action="enviar.php" method="post" enctype="multipart/form-data"&gt;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;Nome:&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;input type="text" class="texto" name="nome" /&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/tr&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;Email:&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;input type="text" class="texto" name="email" /&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/tr&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;Assunto:&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;input type="text" class="texto" name="assunto" /&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/tr&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;Mensagem&lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;textarea name="mensagem"&gt;&lt;/textarea&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/tr&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;a href="index.php"&gt;Atualizar&lt;/a&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;input type="submit" name="enviar" class="bottom"/&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/td&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/tr&gt;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &lt;/form&gt;<br />&lt;/table&gt;</b><br />{% endhighlight %}<br /><br /><blockquote class="tr_bq">&nbsp;<b>E aqui o arquivo enviar.php</b></blockquote><br />{% highlight bash %}<br /><b>&lt;?php<br />&nbsp; <span style="color: blue;">/* se apertar em enviar dados entra no processo*/</span><br />&nbsp; if(isset($_POST['enviar']))<br />&nbsp; {<br />&nbsp; <span style="color: blue;">/* extraimos o POST para criar as variaveis automaticamente pelo nome do FORM */</span><br />&nbsp;&nbsp;&nbsp;&nbsp; extract($_POST);<br />&nbsp; <span style="color: blue;">/* CASO ALGUM CAMPO ESTEJA VAZIO, aconselho não colocar mensagem por campo e sim completo por motivos de segurança */</span><br />&nbsp;&nbsp;&nbsp;&nbsp; if(empty($nome)&nbsp;&nbsp;&nbsp;&nbsp; ||<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; empty($email)&nbsp;&nbsp;&nbsp; ||<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; empty($assunto)&nbsp; ||<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; empty($mensagem) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo 'Um ou mais campos está(ão) vazio(s).';<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">/* utilizando Expressão Regular, verificamos se o formato do email é válido, </span><a href="http://marcospinguim.blogspot.com/2011/11/utilizando-expressoes-regulares.html" style="color: #274e13;" target="_blank">clique aqui</a><span style="color: blue;"> pra saber mais sobre Expressões Regulares */</span><br />&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp; else if(!preg_match("/^[a-z0-9_\.\-]+@[a-z0-9_\.\-]*[a-z0-9_\-]+\.[a-z]{2,4}$/i", $email))<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo 'Informe um email válido.';<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">/* preparamos o arquivo para envio */</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $corpo = 'Nome: '.$nome.'&lt;br /&gt;Email: '.$email.'&lt;br /&gt;Mensagem: &lt;br /&gt;&lt;br /&gt;'.$mensagem;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">/* criamos uma função para chamar os métodos da Classe PHPMailer */</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function sendMail($assunto,$corpo,$remetente,$nomeRemetente,$destino,$nomeDestino){<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue;">/* Incluimos a class, lembrando que essa classe é o arquivo baixado e está dentro da pasta PHPMailer, renomei */</span><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; require_once('PHPMailer/class.phpmailer.php');<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue;">/* Instanciamos a class */</span><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail = new PHPMailer(); //inicia a classe<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue;">/* Setamos os métodos necessários para o funcionamento */</span><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;IsSMTP();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;SMTPAuth = true;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;Host = 'smtp.gmail.com';<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;Port = '587';<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;SMTPSecure = "tls";<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue;">/* digite aqui o seu email que fará a autenticação de envio */</span><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;Username = 'SEU_EMAIL@gmail.com';<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue;">/* coloque a senha desse email */</span><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;Password = 'SUA_SENHA_DO_EMAIL_ACIMA';<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;From = $remetente;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;FromName = utf8_decode($nomeRemetente);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;IsHTML(true);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;Subject = utf8_decode($assunto); //assunto<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;Body = utf8_decode($corpo); //mensagem<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; $mail-&gt;AddAddress($destino,utf8_decode($nomeDestino)); //email e nome do destino<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue;">/* caso haja erro no envio */</span><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; if(!$mail-&gt;Send()){<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; echo 'Erro ao enviar mensagem.';<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue;">/* caso o envio esteja correto */</span><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; }else{<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; echo 'Sua mensagem foi enviada com sucesso!';<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">/* preparamos a mensagem de resposta */</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $resposta = 'Olá '.$nome.'!&lt;br /&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Obrigado por entrar em contato!&lt;br /&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Em breve responderemos.&lt;br /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Atenciosamente,&lt;br /&gt;&lt;br /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUA ASSINATURA.&lt;br /&gt;';<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">/* envia o email para você */</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendMail($assunto,$corpo,$email,$nome,'SEU_EMAIL@gmail.com','SUA MENSAGEM');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">/* envia o email de resposta */</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendMail('Olá '.$nome.', recebemos sua mensagem',$resposta,'SEU_EMAIL@gmail.com','SEU TITULO',$email,$nome);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<span style="color: blue;">/* else dos campos vazios e da ExReg */</span><br />&nbsp; }<br />?&gt; </b><br />{% endhighlight %}<br /><b>Pronto, é isso, qualquer dúvida é só comentar</b>