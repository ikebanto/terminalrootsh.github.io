---
layout: post
title: Como executar um script ao iniciar sessão no Debian
date: '2015-08-04T08:44:00.001-07:00'
description: Como executar um script ao iniciar sessão no Debian
main-class: 'debian'
color: '#de4508'
author: Marcos Oliveira
tags:
- Debian
- MATE
- Dicas
modified_time: '2015-08-04T09:44:05.184-07:00'
thumbnail: http://4.bp.blogspot.com/-2slbFwk2sqI/VcDaJpzO8GI/AAAAAAAABmw/U-lTIWISAM8/s72-c/xsession.jpg
twitter_text: Como executar um script ao iniciar sessão no Debian
introduction: Como executar um script ao iniciar sessão no Debian
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-2slbFwk2sqI/VcDaJpzO8GI/AAAAAAAABmw/U-lTIWISAM8/s1600/xsession.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-2slbFwk2sqI/VcDaJpzO8GI/AAAAAAAABmw/U-lTIWISAM8/s400/xsession.jpg" /></a></div><br /><h3>Há situações que você precisa que iniciar um script ao iniciar sessão. Existem várias formas pŕaticas para fazer isso, aqui vou mostrar de algumas maneiras, começando pelas mais simples.</h3><br /><b>Se você criou um <span style="font-size: large;">script</span> e deseja que ele execute sempre que você iniciar uma nova sessão basta vc colocar o caminho da execução dentro do arquivo <span style="color: blue;"><span style="font-size: x-large;">.xsessionrc</span></span> na sua pasta raíz, lógico que esse script precisa ter permissão de execução: <span style="font-size: large;">chmod +x script</span><br /><br />Nesse post&nbsp; <a href="http://www.terminalroot.com.br/2015/08/enviando-e-mail-via-terminal.html" target="_blank"><span style="color: blue;"><span style="font-size: x-large;">Enviando e-mail via Terminal</span></span></a>&nbsp; , mostrei como enviar e-mail pelo terminal , mas suponhamos que você , por questão de segurança , deseje obter um e-mail sempre que iniciar uma sessão no seu perfil, então você criou esse script (altere a variavel local <span style="font-size: large;"><span style="color: purple;">destinatario</span></span> pra o e-mail que você deseja receber a notificação):</b><br /><div class="adp"><b><span style="color: blue;">#!/bin/bash</span></b><br /><b><span style="color: blue;"># Enviar e-mail ao iniciar sessão</span></b><br /><b><br /></b><b><span style="color: #38761d;">sendsession()</span>{</b><br /><b><br /></b><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">local</span> distro=<span style="color: magenta;">"$(cat /etc/issue | awk '{print <span style="color: #073763;">$1</span>,<span style="color: #073763;">$2</span>,<span style="color: #073763;">$3</span>}')"</span>;</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">local</span> nome=<span style="color: magenta;">"$(echo <span style="color: #073763;">$USER</span> | sed 's/./\U&amp;/')"</span>;</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">local</span> data="$(date +%d/%m/%Y)";</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">local</span> hora="$(date +%H:%M:%S)";</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">local</span> conteudo=<span style="color: magenta;">"<span style="color: #073763;">$nome</span>, sua máquina <span style="color: #073763;">$distro</span> Iniciou sessão no dia <span style="color: #073763;">$data</span> às <span style="color: #073763;">$hora</span>."</span>;</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">local</span> assunto=<span style="color: magenta;">"Nova sessão no <span style="color: #073763;">$distro</span>"</span>;</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">local</span> destinatario=<span style="color: red;">"SEUEMAIL@gmail.com"</span>;</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">echo</span> <span style="color: magenta;">"<span style="color: #073763;">$conteudo</span>" <span style="color: #660000;">|</span> <span style="color: black;">mutt -s</span> "<span style="color: #073763;">$assunto</span>" <span style="color: #073763;">$destinatario</span></span>;</b><br /><b>&nbsp;&nbsp;&nbsp; <span style="color: #660000;">exit</span> 0</b><br /><b>&nbsp;&nbsp;&nbsp; </b><br /><b>}</b><br /><b><br /></b><b>sendsession</b></div><b><br /><br />então você salva no diretório que você deseja com as devidas permissões:<br /><br />{% highlight bash %}chmod +x ~/scripts/enviar.sh{% endhighlight %}<br /><br />Depois é só criar um arquivo <span style="font-size: large;"><span style="color: blue;">~/.xsessionrc</span></span> e pôr o caminho da execução do script:<br /><br />{% highlight bash %}echo "/home/user/scripts/enviar.sh" &gt; ~/.xsessionrc{% endhighlight %}<br /><br /><span style="font-size: large;">Pronto, agora sempre que uma sessão foi iniciada no seu perfil, você receberá uma e-mail informando-o!</span><br /><br />o Xsession é para informações de sessão , se você usar o <span style="color: red;">~/.initrc</span> só funcionará quando o X for iniciado e não a sessão , ou seja , quando reinciar a máquina ou ligar (partir do modo texto para o gráfico, "startx"), logo ,&nbsp; usar o .xsessionrc convém mais, até porque se alguém encerrar sessão e quiser entrar no seu perfil, sem reiniciar a máquina , você também receberá o e-mail :) .<br /><br />Você também pode usar pela Interface Gráfica , todas as GUIs modernas possuem , procure por "Aplicativos de sessão" na pesquisa da sua GUI ou tente encontrar em Preferencias. No MATE Desktop por exemplo o caminho no MENU PRINCIPAL é:<br /><br /><span style="color: purple;"><span style="font-size: large;">Sistema &gt; Preferencias &gt; Aplicativos de sessão.</span></span><br /><br />Clique em <span style="font-size: large;">[ADICIONAR]</span>, abrirá uma nova janela, preencha os dados como você deseja de acordo com o exemplo da imagem abaixo e clique em <span style="font-size: large;">[ADICIONAR]</span> de novo, e pronto, funcionará do mesmo jeito:<br /><br />   [IMG1] </b><br /><div class="separator" style="clear: both; text-align: center;"><b><a href="http://1.bp.blogspot.com/-k9MhRm-Y26w/VcDce4cj5YI/AAAAAAAABm8/kSEQukO0VzE/s1600/Captura_de_tela.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="438" src="http://1.bp.blogspot.com/-k9MhRm-Y26w/VcDce4cj5YI/AAAAAAAABm8/kSEQukO0VzE/s640/Captura_de_tela.png" width="640" /></a></b></div><b>  <br /><br />Outra forma é você criar um script inicializável do sistema e não só do seu usuário, mas precisa ser <span style="color: blue;"><span style="font-size: x-large;">ROOT</span></span> , exemplo:<br /><br />Crie um daemon baseado no exemplo que o próprio Debian possui em <span style="color: blue;"><span style="font-size: large;">/etc/init.d/skeleton</span></span> e altere de acordo com as informações do seu script , o mais importante é alterar a linha que possui <span style="color: blue;"><span style="font-size: large;">DAEMON=/usr/sbin/daemonexecutablename</span></span> para o caminho do seu script e se quis, exemplo:<br /><br />{% highlight bash %}vi /etc/init.d/enviar{% endhighlight %}</b><br /><div class="adp"><b><br /></b><b>### BEGIN INIT INFO</b><br /><b># Provides:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enviar</b><br /><b># Required-Start:&nbsp;&nbsp;&nbsp; $remote_fs $syslog</b><br /><b># Required-Stop:&nbsp;&nbsp;&nbsp;&nbsp; $remote_fs $syslog</b><br /><b># Default-Start:&nbsp;&nbsp;&nbsp;&nbsp; 2 3 4 5</b><br /><b># Default-Stop:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 1 6</b><br /><b># Short-Description: Envia e-mail</b><br /><b># Description:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sempre que inciar sessão</b><br /><b>### END INIT INFO</b><br /><b><br /></b><b># Author: Foo Bar &lt;foobar@baz.org&gt;</b><br /><b>DESC="Descrição do Serviço"</b><br /><b>DAEMON=/usr/sbin/enviar</b></div><b><br /><br />Veja que usei o caminho <span style="color: blue;"><span style="font-size: large;">/usr/sbin/enviar</span></span> , logo preciso mover o arquivo para lá!<br /><br />Depois você precisa pôr o </b><span style="font-size: large;">daemon</span><b> na para rodar na inicialização:<br /><br />Assim:<br />{% highlight bash %}# update-rc.d enviar defaults{% endhighlight %}<br /><br />Ou assim, melhor assim se você possui o Jessie 8:<br />{% highlight bash %}# insserv enviar{% endhighlight %}<br /><br />Caso você deseje retirá da incialização:<br /><br />Assim:<br />{% highlight bash %}# update-rc.d -f enviar remove{% endhighlight %}<br /><br />Ou assim, melhor assim se você possui o Jessie 8:<br />{% highlight bash %}# insserv -r enviar{% endhighlight %}<br />ou<br />{% highlight bash %}# insserv --remove enviar{% endhighlight %}<br /><br /><br />Via:<br /><a href="https://wiki.debian.org/XWindowSystem" target="_blank">https://wiki.debian.org/XWindowSystem</a><br /><a href="https://wiki.debian.org/Xinitrc" target="_blank">https://wiki.debian.org/Xinitrc</a><br /><a href="https://wiki.debian.org/Daemon" target="_blank">https://wiki.debian.org/Daemon</a></b>